{"version":3,"sources":["themes/charts sync /^/.*/.json$","themes/loadTheme.js","themes/StyledGenericChart.js","context/win.js","context/theme.js","helpers/qlikApp.js","context/qlik.js","context/objects.js","helpers/index.js","context/selections.js","assets/icons/close.svg","assets/icons/done.svg","components/atoms/IconButton.js","components/molecules/ScatterPlot.js","components/molecules/BarChart.js","components/molecules/LineChart.js","components/molecules/PieChart.js","components/molecules/ChartTooltip.js","components/organisms/Chart.js","hooks/useChecks.js","assets/icons/step_back.svg","assets/icons/step_next.svg","assets/icons/cancel.svg","components/molecules/SelectionsFieldList.js","hooks/usePrevious.js","components/organisms/SelectionsBar.js","App.js","serviceWorker.js","context/GlobalProvider.js","index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","themeNames","themes","x","name","data","require","makeSafe","seqInt","gradients","sequential","d3","divInt","backgroundColor","axisText","axisLines","gridLines","labels","title","xAxis","yAxis","diverging","selectionHighlight","colorScales","domain","viewbox","backgroundFill","selectionFill","selectionStroke","loadTheme","themeName","theme","find","styled","div","stroke","strokeWidth","color","fontFamily","fontSize","fontWeight","WinContext","React","createContext","width","window","innerWidth","height","innerHeight","WinProvider","children","useState","win","setWin","useEffect","handleResize","throttle","addEventListener","removeEventListener","Provider","value","ThemeContext","ThemeProvider","setThemeName","setTheme","enigma","schema","config","host","isSecure","port","prefix","appId","identity","URLSearchParams","location","search","get","session","create","url","closeSession","close","QlikContext","QlikProvider","app","setApp","computing","setComputing","Promise","reject","open","then","qlik","openDoc","qDoc","catch","err","on","console","log","evt","eventName","res","defaultProps","ObjectsContext","ObjectsProvider","useContext","qlikContext","objects","setObjects","saveObjectToState","useCallback","newObj","curr","removeObjectFromState","i","findIndex","splice","getObject","a","model","getProperties","props","qHyperCubeDef","qInitialDataFetch","qTop","qLeft","qWidth","qHeight","setProperties","type","createObject","def","ref","qType","key","objDef","qInfo","createSessionObject","getObjectLayout","layout","getLayout","setTimeout","destroyObject","destroySessionObject","ordinalize","n","s","v","calculateTextSpace","str","svg","document","createElement","el","appendChild","createTextNode","style","visibility","whiteSpace","body","getBoundingClientRect","removeChild","getApiFromType","path","object","SelectionsContext","SelectionsProvider","selectedModelId","selectedModelType","isSelecting","values","state","setState","modelId","setModelId","saveSelectionsStart","payload","saveSelectionsEnd","updateSelectedValues","stopIfSelecting","endSelections","beginSelections","saveChanges","selectValues","toggle","length","selectHyperCubeValues","selectListObjectValues","stateValues","forEach","push","filter","clearFieldSelections","qFieldName","getField","clear","selections","_extends","assign","target","arguments","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","d","fill","_ref","svgRef","viewBox","ForwardRef","forwardRef","IconButton","button","CancelButton","ConfirmButton","xValue","measures","yValue","sizeValue","ScatterPlot","newData","onDimensionClick","dotSizeRange","xTickFormat","yTickFormat","xTickCount","yTickCount","TooltipComponent","svgContainer","useRef","toolTipRef","w","setW","h","setH","y","scales","setScales","setData","xLabel","label","yLabel","margin","left","right","top","bottom","isEqual","nice","range","g","current","select","dotSizeScale","colorScale","points","selectAll","enter","append","attr","merge","transition","duration","includes","qElemNumber","exit","remove","tooltip","circles","text","dimensions","html","format","tickSize","tickFormat","ticks","className","pointerEvents","transform","textAnchor","lasso","BarChart","lassoA","lassoActive","hasLasso","chartTitle","chartData","setChartData","h2","setH2","boxY","boxX","readyToRender","setReadyToRender","Math","min","max","middle","setMargin","scaleTo","reduce","acc","sqrt","pow","sumMargin","viewboxHeight","padding","xScale","yScale","boxYScale","boxXScale","mainBars","viewboxBars","allBars","percentiles","lower","upper","extent","zoom","scaleExtent","translateExtent","wheelDelta","getOpacity","isViewbox","elemArray","parentNode","matches","getHeight","brush","sourceEvent","selection","bandwidth","move","k","applyX","t","invertX","getViewboxHeight","nodes","las","closePathSelect","closePathDistance","items","targetArea","classed","possibleItems","notPossibleItems","onLassoEnd","selected","selectedItems","each","notSelectedItems","replace","LineChart","sort","b","x0","x1","dx","padLinear","datum","clipPath","getValue","StyledTooltip","show","ChartTooltip","charts","offsetAngle","setOffsetAngle","arcData","padAngle","startAngle","endAngle","paths","radius","getArc","innerRadius","outerRadius","largeArc","smallArc","getPathOpacity","centroid","abs","round","coords","onWheel","delt","deltaY","sign","ChartContainer","ChartControls","Chart","documentTitle","objectId","propTheme","propChartType","propHeight","dimMeasureCheck","dims","compName","entries","dim","field","measure","formula","checkExpression","isValid","qErrorMsg","qBadFieldNames","qDangerousFieldNames","warn","useChecks","contextTheme","containerRef","chartType","showChart","setShowChart","setModel","setWidth","setHeight","toSet","join","updateLayout","qHyperCube","dimInfo","qDimensionInfo","mesInfo","qMeasureInfo","qDataPages","qMatrix","slice","qFallbackTitle","qNum","qText","m","qDimensions","qDef","qFieldDefs","qNullSuppression","excludeNull","qMeasures","sorting","qSortBy","RequestedChart","borderColor","display","onClick","StyledGenericChart","xlinkHref","overflow","FieldListContainer","ValuesList","ValueButtons","ValueItem","SelectionsFieldList","onRequestClose","onClickAway","fieldInfo","fieldIndex","isExpanded","onExpand","onClose","indexOfEl","setValues","oldModelId","usePrevious","isSubscribed","handleClick","isOutside","elem","setLayout","qListObject","flat","qField","qSortCriterias","qSortByState","qShowAlternatives","elems","qState","SelectionBarContainer","OptionsContainer","FieldsContainer","FieldSummary","SelectionsBar","fields","setFields","selectedField","setSelectedField","selectionBarRef","qSelectionObject","qSelections","handleRequestClose","handleClickAway","back","forward","info","index","handleFieldClick","substr","qSelectedCount","qTotal","qSelected","getSelectedString","fieldName","stopPropagation","App","component","Boolean","hostname","match","GlobalProvider","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.56cb7464.chunk.js","sourcesContent":["var map = {\n\t\"./standard.json\": 67,\n\t\"./sunsetblue.json\": 68\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 66;","import * as d3 from 'd3'\r\n\r\nconst themeNames = ['standard', 'sunsetblue']\r\n\r\nexport { themeNames as themes }\r\n\r\nconst themes = themeNames.map(x => ({\r\n  name: x,\r\n  data: require(`./charts/${x}.json`)\r\n}))\r\n\r\nvar interpolators = [\r\n  // These are from d3-scale.\r\n  \"Viridis\",\r\n  \"Inferno\",\r\n  \"Magma\",\r\n  \"Plasma\",\r\n  \"Warm\",\r\n  \"Cool\",\r\n  \"Rainbow\",\r\n  \"CubehelixDefault\",\r\n  // These are from d3-scale-chromatic\r\n  \"Blues\",\r\n  \"Greens\",\r\n  \"Greys\",\r\n  \"Oranges\",\r\n  \"Purples\",\r\n  \"Reds\",\r\n  \"BuGn\",\r\n  \"BuPu\",\r\n  \"GnBu\",\r\n  \"OrRd\",\r\n  \"PuBuGn\",\r\n  \"PuBu\",\r\n  \"PuRd\",\r\n  \"RdPu\",\r\n  \"YlGnBu\",\r\n  \"YlGn\",\r\n  \"YlOrBr\",\r\n  \"YlOrRd\"\r\n]\r\n\r\nfunction makeSafe(e) {\r\n  const seqInt = typeof e.gradients.sequential === 'string' \r\n    ? d3['interpolate' + e.gradients.sequential] \r\n    : d3.interpolateRgbBasis(e.gradients.sequential)\r\n  const seqScale = domain => d3.scaleSequential(seqInt).domain(domain)\r\n  const divInt = typeof e.gradients.sequential === 'string' \r\n    ? d3['interpolate' + e.gradients.sequential] \r\n    : d3.interpolateRgbBasis(e.gradients.sequential)\r\n  const divScale = domain => d3.scaleDiverging(divInt).domain(domain)\r\n  return {\r\n    backgroundColor: e.backgroundColor,\r\n    axisText: e.axisText || {},\r\n    axisLines: e.axisLines || {},\r\n    gridLines: e.gridLines || false,\r\n    labels: {\r\n      ...e.labels,\r\n      title: (e.labels && e.labels.title) || {},\r\n      xAxis: (e.labels && e.labels.xAxis) || {},\r\n      yAxis: (e.labels && e.labels.yAxis) || {},\r\n    },\r\n    gradients: {\r\n      sequential: (e.gradients && e.gradients.sequential) || {\r\n        '0': '#020024',\r\n        '37': '#090979',\r\n        '100': '#00d4ff'\r\n      },\r\n      diverging: (e.gradients && e.gradients.diverging) || {\r\n        '0': '#e42d21',\r\n        '47': '#e8e0bb',\r\n        '100': '#56d73c'\r\n      }\r\n    },\r\n    selectionHighlight: e.selectionHighlight || '#737373',\r\n    colorScales: {\r\n      sequential: seqScale,\r\n      diverging: divScale\r\n    },\r\n    viewbox: e.viewbox || {\r\n      backgroundFill: \"none\",\r\n      selectionFill: \"rgba(0,0,0,0.1)\",\r\n      selectionStroke: \"#ddd\"\r\n    }\r\n  }\r\n}\r\n\r\nexport default function loadTheme(themeName) {\r\n  let theme = themes.find(x => x.name === themeName)\r\n  if(!theme) {\r\n    return makeSafe(themes[0].data)\r\n  }\r\n  return makeSafe(theme.data)\r\n}","import styled from 'styled-components'\r\n\r\nexport default styled.div`\r\n  svg {\r\n    background-color: ${({theme}) => theme.backgroundColor}\r\n  }\r\n  .axis {\r\n    .tick line {\r\n      stroke: ${({theme}) => theme.axisLines.stroke || (theme.gridLines ? theme.gridLines.stroke : null)};\r\n      stroke-width: ${({theme}) => theme.gridLines ? theme.gridLines.strokeWidth : null};\r\n      display: ${({theme}) => theme.gridLines ? 'auto' : 'none'}\r\n    }\r\n    text {\r\n      fill: ${({theme}) => theme.axisText.color};\r\n      font-family: '${({theme}) => theme.axisText.fontFamily}', sans-serif;\r\n      font-size: ${({theme}) => theme.axisText.fontSize};\r\n      font-weight: ${({theme}) => theme.axisText.fontWeight};\r\n    }\r\n    .domain {\r\n      stroke: ${({theme}) => theme.axisLines.stroke};\r\n    }\r\n  }\r\n  .brush .selection {\r\n    fill: ${({theme}) => theme.viewbox.selectionFill};\r\n    stroke: ${({theme}) => theme.viewbox.selectionStroke};\r\n  }\r\n  .x-axis-label {\r\n    fill: ${({theme}) => theme.labels.xAxis.color || theme.labels.color};\r\n    font-weight: ${({theme}) => theme.labels.xAxis.fontWeight || theme.labels.fontWeight};\r\n    font-size: ${({theme}) => theme.labels.xAxis.fontSize || theme.labels.fontSize};\r\n    font-family: '${({theme}) => theme.labels.xAxis.fontFamily || theme.labels.fontFamily}', sans-serif;\r\n  }\r\n  .y-axis-label {\r\n    fill: ${({theme}) => theme.labels.yAxis.color || theme.labels.color};\r\n    font-weight: ${({theme}) => theme.labels.yAxis.fontWeight || theme.labels.fontWeight};\r\n    font-size: ${({theme}) => theme.labels.yAxis.fontSize || theme.labels.fontSize};\r\n    font-family: '${({theme}) => theme.labels.yAxis.fontFamily || theme.labels.fontFamily}', sans-serif;\r\n  }\r\n`","import React, { useState, useEffect } from 'react'\r\n\r\nimport throttle from 'lodash.throttle'\r\n\r\nconst WinContext = React.createContext({\r\n  width: window.innerWidth,\r\n  height: window.innerHeight\r\n})\r\n\r\nexport default WinContext\r\n\r\nexport const WinProvider = ({children}) => {\r\n  const [win, setWin] = useState({\r\n    width: window.innerWidth,\r\n    height: window.innerHeight\r\n  })\r\n\r\n  useEffect(() => {\r\n    const handleResize = throttle(() => {\r\n      setWin({\r\n        width: window.innerWidth,\r\n        height: window.innerHeight\r\n      })\r\n    }, 300)\r\n    window.addEventListener('resize', handleResize)\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize)\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <WinContext.Provider value={win}>\r\n      {children}\r\n    </WinContext.Provider>\r\n  )\r\n}","import React, { useState } from 'react'\r\n\r\nimport loadTheme, { themes } from 'themes/loadTheme'\r\n\r\nconst ThemeContext = React.createContext(null)\r\n\r\nexport default ThemeContext\r\n\r\nconst ThemeProvider = ({children}) => {\r\n  const [themeName, setThemeName] = useState('sunsetblue')\r\n  const [theme, setTheme] = useState(loadTheme(themes[1]))\r\n\r\n  const handleChangeTheme = theme => {\r\n    setThemeName(theme)\r\n    setTheme(loadTheme(theme))\r\n  }\r\n\r\n  return (\r\n    <ThemeContext.Provider value={{theme, themeName, setTheme: handleChangeTheme}}>\r\n      {children}\r\n    </ThemeContext.Provider>\r\n  )\r\n}\r\n\r\nexport {ThemeProvider}","const enigma = require('enigma.js')\r\nconst schema = require('enigma.js/schemas/12.20.0.json')\r\n\r\nlet config = {\r\n  host: 'localhost',\r\n  isSecure: false,\r\n  port: 4848,\r\n  prefix: '',\r\n  appId: 'Consumer Sales.qvf',\r\n  identity: new URLSearchParams(window.location.search).get('identity') || 'openfin',\r\n}\r\n\r\n// config = {\r\n//   host: \"sense1.calibrateconsulting.com\",\r\n//   isSecure: true,\r\n//   port: 443,\r\n//   prefix: \"\",\r\n//   appId: \"6729311b-f919-4bd2-93a8-872f7271856c\",\r\n// }\r\n\r\nconst session = enigma.create({\r\n  schema,\r\n  url: `ws${config.isSecure ? 's' : ''}://${config.host}:${config.port}/${config.prefix ? `${config.prefix}/` : ''}app/engineData/identity/${config.identity}`,\r\n  // createSocket: (url) => new WebSocket(url),\r\n})\r\n\r\nexport function openSession() {\r\n  return new Promise((resolve, reject) => {\r\n    session\r\n      .open()\r\n      .then((qlik) => {\r\n        qlik.openDoc(config.appId).then((qDoc) => {\r\n          resolve(qDoc)\r\n        })\r\n      })\r\n      .catch((err) => {\r\n        reject(err)\r\n      })\r\n    session.on('opened', () => {\r\n      console.log('session; opened')\r\n    })\r\n    session.on('closed', () => {\r\n      console.log('session; closed')\r\n    })\r\n    session.on('suspended', (evt) => {\r\n      // qlik ended\r\n      console.log('session; suspended', evt)\r\n    })\r\n    session.on('resumed', () => {\r\n      console.log('session; resumed')\r\n    })\r\n    session.on('notification:*', (eventName, data) => console.log(`notification:${eventName}`, data))\r\n    // session.on('traffic:sent', (req) => console.log('traffic:sent', req));\r\n    // session.on('traffic:received', (res) => console.log('traffic: received', res));\r\n    session.on('socket-error', (res) => {\r\n      console.log('socket-error', res)\r\n    })\r\n  })\r\n}\r\n\r\nexport function closeSession() {\r\n  session.close()\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport { openSession, closeSession } from '../helpers/qlikApp.js'\r\n\r\nconst QlikContext = React.createContext(null)\r\nexport default QlikContext\r\n\r\nconst QlikProvider = ({children}) => {\r\n  const [app, setApp] = useState(null)\r\n  const [computing, setComputing] = useState(false)\r\n\r\n  useEffect(() => {\r\n    openSession().then(app => {\r\n      setApp(app)\r\n    })\r\n    return closeSession\r\n  }, [])\r\n\r\n  return (\r\n    <>\r\n      { !app ? <p>Loading...</p> : \r\n      <QlikContext.Provider value={{app, computing, setComputing}}>\r\n        {children}\r\n      </QlikContext.Provider> }\r\n    </>\r\n  )\r\n}\r\n\r\nQlikProvider.propTypes = {\r\n  children: PropTypes.oneOfType([\r\n    PropTypes.arrayOf(PropTypes.node),\r\n    PropTypes.node,\r\n  ]),\r\n}\r\nQlikProvider.defaultProps = {\r\n  children: null,\r\n}\r\n\r\nexport { QlikProvider }","import React, { useState, useContext, useCallback } from 'react'\r\n\r\nimport qlikContext from 'context/qlik'\r\n\r\nconst ObjectsContext = React.createContext(null)\r\nexport default ObjectsContext\r\n\r\nconst ObjectsProvider = ({ children }) => {\r\n  const {app, computing} = useContext(qlikContext)\r\n\r\n  const [objects, setObjects] = useState([])\r\n\r\n  // state updates\r\n  const saveObjectToState = useCallback(newObj => {\r\n    setObjects(curr => [...curr, newObj])\r\n  }, [])\r\n  const removeObjectFromState = useCallback(id => {\r\n    const i = objects.findIndex(x => x.id === id)\r\n    setObjects(curr => {\r\n      const next = [...curr].splice(i, 1)\r\n      return next\r\n    })\r\n  }, [objects])\r\n\r\n  // logic\r\n  const getObject = useCallback(async id => {\r\n    let model\r\n    try {\r\n      model = await app.getObject(id)\r\n    }\r\n    catch(err) {\r\n      console.log(err)\r\n      throw new Error(`Whoops, couldn't find the requested object with id \"${id}\", in the connected qlik app. Please check the object id and try again`)\r\n    }\r\n    const props = await model.getProperties()\r\n    props.qHyperCubeDef.qInitialDataFetch = [{ qTop: 0, qLeft: 0, qWidth: 10, qHeight: 100 }]\r\n    await model.setProperties(props)\r\n    saveObjectToState({ \r\n      id: model.id,\r\n      type: 'cube'\r\n    })\r\n    return model\r\n  }, [app, saveObjectToState])\r\n\r\n  const createObject = useCallback(async (type, def, ref) => {\r\n    let qType, key\r\n    switch(type) {\r\n      case 'cube':\r\n        qType = 'qHyperCube'\r\n        key = 'qHyperCubeDef'\r\n        break\r\n      case 'list':\r\n        qType = 'qListObject'\r\n        key = 'qListObjectDef'\r\n        break\r\n      case 'selections':\r\n        qType = 'CurrentSelections'\r\n        key = 'qSelectionObjectDef'\r\n        break\r\n      default:\r\n        qType = null\r\n        key = null\r\n        break\r\n    }\r\n    let objDef\r\n    if(qType && key) {\r\n      objDef = {\r\n        qInfo: {\r\n          qType: ref || qType\r\n        },\r\n        [key]: def || {}\r\n      }\r\n    } else {\r\n      objDef = type\r\n    }\r\n    return app.createSessionObject(objDef)\r\n    .then(model => {\r\n      saveObjectToState({ \r\n        id: model.id,\r\n        type: type,\r\n        ref\r\n      })\r\n      return model\r\n    })\r\n  }, [app, saveObjectToState])\r\n\r\n  const timer = () => new Promise(res => setTimeout(res, 200))\r\n\r\n  const getObjectLayout = useCallback(async model => {\r\n    for(var i=0; i<20; i++) {\r\n      if(!computing) {\r\n        let layout\r\n        while(!layout) {\r\n          try {\r\n            layout = await model.getLayout()\r\n          }\r\n          catch(err) {\r\n            await timer()\r\n          }\r\n        }\r\n        return layout\r\n      }\r\n    }\r\n  }, [computing])\r\n\r\n  const destroyObject = useCallback(async id => {\r\n    await app.destroySessionObject(id)\r\n    removeObjectFromState(id)\r\n  }, [app, removeObjectFromState])\r\n\r\n  return (\r\n    <ObjectsContext.Provider \r\n      value={{\r\n        objects,\r\n        createObject,\r\n        getObject,\r\n        getObjectLayout,\r\n        destroyObject,\r\n      }}\r\n    >\r\n      {children}\r\n    </ObjectsContext.Provider>\r\n  )\r\n}\r\n\r\nexport { ObjectsProvider }","export function ordinalize(n) {\r\n  var s=[\"th\",\"st\",\"nd\",\"rd\"],\r\n  v=n%100\r\n  return n+(s[(v-20)%10]||s[v]||s[0])\r\n}\r\n\r\nexport function calculateTextSpace(str, fontSize, fontFamily) {\r\n  const svg = document.createElement('svg')\r\n  const el = document.createElement('text')\r\n  el.appendChild(document.createTextNode(str))\r\n  el.style.fontSize = fontSize\r\n  el.style.fontFamily = fontFamily\r\n  el.style.visibility = 'hidden'\r\n  el.style.whiteSpace = 'nowrap'\r\n  svg.appendChild(el)\r\n  document.body.appendChild(svg)\r\n  const { width } = el.getBoundingClientRect()\r\n  document.body.removeChild(svg)\r\n  return width\r\n}\r\n\r\nexport const getApiFromType = type => {\r\n  let path\r\n  let object\r\n  switch(type) {\r\n    case 'cube':\r\n      path = '/qHyperCubeDef'\r\n      object = 'qHyperCube'\r\n      break\r\n    case 'list':\r\n      path = '/qListObjectDef'\r\n      object = 'qListObject'\r\n      break\r\n    default:\r\n      throw new Error('NOT IMPLEMENTED')\r\n  }\r\n  return { path, object }\r\n}\r\n\r\nconst validateLength = (props, propName, componentName, min, max) => {\r\n  if(!props[propName]) {\r\n    return new Error(`You must provide data with at least one ${propName} to ${componentName}`)\r\n  }\r\n  const length = props[propName].length\r\n  const required = min === max ? `exactly ${min}` : `between ${min} and ${max}`\r\n  if(length < min || length > max) {\r\n    return new Error(`You must provide data with ${required} ${propName} to ${componentName}. Your data has ${length}`)\r\n  }\r\n  return null\r\n}\r\n  \r\nexport const validateDimensions = (props, propName, componentName, min, max) => {\r\n  // for(const [i, x] of props[propName].entries()) {\r\n  //   if(typeof x !== 'string') {\r\n  //     return new Error(`${ordinalize(i + 1)} dimension passed to ${componentName} is not a string. Dimensions must be strings.`)\r\n  //   }\r\n  // }\r\n  return validateLength(props, propName, componentName, min, max)\r\n}\r\n\r\nexport const validateMeasures = (props, propName, componentName, min, max) => {\r\n//   for(const [i, x] of props[propName].entries()) {\r\n//     if(typeof x !== 'number') {\r\n//       return new Error(`${ordinalize(i + 1)} measure passed to ${componentName} is not a number. Measures must be numbers.\r\n// Please check your data array. Consider passing 'excludeNull' to dimensions to enable null supression`)\r\n//     }\r\n//   }\r\n  return validateLength(props, propName, componentName, min, max)\r\n}","import React, { useState, useEffect, useContext, useCallback } from 'react'\r\n\r\nimport QlikContext from 'context/qlik'\r\nimport ObjectsContext from 'context/objects'\r\nimport {getApiFromType} from 'helpers'\r\n\r\nconst SelectionsContext = React.createContext(null)\r\nexport default SelectionsContext\r\n\r\nconst SelectionsProvider = ({ children }) => {\r\n  const {app, setComputing} = useContext(QlikContext)\r\n  const {objects, createObject, destroyObject} = useContext(ObjectsContext)\r\n\r\n  const [state, setState] = useState({\r\n    selectedModelId: null,\r\n    selectedModelType: null,\r\n    isSelecting: false,\r\n    values: []\r\n  })\r\n\r\n  const [modelId, setModelId] = useState(null)\r\n\r\n  // state updates\r\n  const saveSelectionsStart = useCallback(payload => {\r\n    const { id, type, values } = payload\r\n    setState(curr => ({\r\n      ...curr,\r\n      selectedModelId: id,\r\n      selectedModelType: type,\r\n      isSelecting: true,\r\n      values: values || []\r\n    }))\r\n  }, [])\r\n  const saveSelectionsEnd = useCallback(() => {\r\n    setState(curr => ({\r\n      ...curr,\r\n      selectedModelId: null,\r\n      selectedModelType: null,\r\n      isSelecting: false,\r\n      values: []\r\n    }))\r\n  }, [])\r\n  const updateSelectedValues = useCallback(values => {\r\n    setState(curr => ({\r\n      ...curr,\r\n      values: values\r\n    }))\r\n  }, [])\r\n  \r\n  const stopIfSelecting = useCallback(async id => {\r\n    const { isSelecting, selectedModelId } = state\r\n    if(!isSelecting || selectedModelId === id) {\r\n      return\r\n    }\r\n    try {\r\n      const model = await app.getObject(selectedModelId)\r\n      setComputing(true)\r\n      await model.endSelections(true)\r\n      setComputing(false)\r\n    }\r\n    catch(err) {\r\n      return new Error(`Couldn't end selections on ${selectedModelId}`)\r\n    }\r\n  }, [app, setComputing, state])\r\n\r\n  // logic\r\n  const beginSelections = useCallback(async id => {\r\n    try {\r\n      await stopIfSelecting(id)\r\n      const { selectedModelId } = state\r\n      const { type } = objects.find(x => x.id === id)\r\n      const { path } = getApiFromType(type)\r\n  \r\n      if(selectedModelId !== id) {\r\n        const model = await app.getObject(id)\r\n        setComputing(true)\r\n        await model.beginSelections([path])\r\n        setComputing(false)\r\n        saveSelectionsStart({ id, type })\r\n      } \r\n      return\r\n    }\r\n    catch(err) {\r\n      return new Error(`Couldn't begin selections on ${id} - ${err}`)\r\n    }\r\n  }, [app, objects, saveSelectionsStart, setComputing, state, stopIfSelecting])\r\n\r\n  \r\n  const endSelections = useCallback(async saveChanges => {\r\n    if(typeof saveChanges === 'undefined') {\r\n      throw new Error(\"'Save changes' boolean parameter is required for endSelections method\")\r\n    }\r\n    const { selectedModelId, isSelecting } = state\r\n    try {\r\n      const model = await app.getObject(selectedModelId)\r\n      if(!isSelecting) {\r\n        return Promise.resolve(\"No selections in progress\")\r\n      }\r\n      setComputing(true)\r\n      await model.endSelections(saveChanges)\r\n      setComputing(false)\r\n      return saveSelectionsEnd()\r\n    }\r\n    catch(err) {\r\n      return new Error(`Couldn't end selections - ${err}`)\r\n    }\r\n  }, [app, saveSelectionsEnd, setComputing, state])\r\n  \r\n  const selectValues = useCallback(async (id, values, toggle) => {\r\n    try {\r\n      const { type } = objects.find(x => x.id === id)\r\n      if(!type) {\r\n        throw new Error(`Whoops, specified object not found (ObjectID ${id})`)\r\n      }\r\n  \r\n      await beginSelections(id)\r\n  \r\n      if(typeof toggle === 'undefined') {\r\n        toggle = state.values.length > 0 && state.selectedModelId === id ? true : false\r\n      }\r\n  \r\n      const model = await app.getObject(id)\r\n      setComputing(true)\r\n      if(type === 'cube') {\r\n        await model.selectHyperCubeValues('/qHyperCubeDef', 0, values, toggle)\r\n      } else if(type === 'list') {\r\n        await model.selectListObjectValues('/qListObjectDef', values, toggle)\r\n      } else {\r\n        return new Error('NOT IMPLEMENTED FOR OBJECT TYPE' + type)\r\n      }\r\n      setComputing(false)\r\n      let stateValues = [...state.values]\r\n      values.forEach(x => {\r\n        const i = stateValues.findIndex(v => v === x)\r\n        if(i > -1) {\r\n          stateValues[i] = null\r\n        } else {\r\n          stateValues.push(x)\r\n        }\r\n      })\r\n      stateValues = stateValues.filter(x => x !== null)\r\n      updateSelectedValues(state.selectedModelId === id ? stateValues : values)\r\n      if(stateValues.length === 0) {\r\n        await endSelections(false)\r\n      }\r\n      \r\n      return Promise.resolve(state.values)\r\n    }\r\n    catch(err) {\r\n      throw new Error(\"Error selecting values - \" + err)\r\n    }\r\n  }, [app, beginSelections, endSelections, objects, setComputing, state.values, updateSelectedValues])\r\n  \r\n  const clearFieldSelections = useCallback(async qFieldName => {\r\n    try {\r\n      const field = await app.getField(qFieldName)\r\n      field.clear()\r\n      return Promise.resolve(`Cleared ${qFieldName} selections`)\r\n    }\r\n    catch(err) {\r\n      return new Error(\"Error clearing field selections\", err)\r\n    }\r\n  }, [app])\r\n\r\n  useEffect(() => {\r\n    createObject('selections').then(model => {\r\n      setModelId(model.id)\r\n    })\r\n    return () => {\r\n      if(modelId) { \r\n        destroyObject(modelId)\r\n      }\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <>\r\n      { modelId ? \r\n        <SelectionsContext.Provider \r\n          value={{\r\n            selections: state,\r\n            beginSelections,\r\n            selectValues,\r\n            endSelections,\r\n            clearFieldSelections\r\n          }}\r\n        >\r\n          {children}\r\n        </SelectionsContext.Provider> : \r\n        <p>Loading</p> }\r\n    </>\r\n  )\r\n}\r\n\r\nexport { SelectionsProvider }","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar SvgClose = function SvgClose(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgClose, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/close.777b93c6.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"none\",\n  d: \"M0 0h24v24H0z\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z\"\n});\n\nvar SvgDone = function SvgDone(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgDone, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/done.e249914e.svg\";\nexport { ForwardRef as ReactComponent };","import styled from 'styled-components'\r\n\r\nconst IconButton = styled.button`\r\n  border: none;\r\n  border-radius: 3px;\r\n  margin: auto 3px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  height: 30px;\r\n  background-color: transparent;\r\n  position: relative;\r\n  outline: none;\r\n  &:hover::after {\r\n    position: absolute;\r\n    content: \"\";\r\n    left: 0; right: 0; top: 0; bottom: 0;\r\n    background-color: rgba(0,0,0,0.05)\r\n  }\r\n  cursor: pointer;\r\n  svg {\r\n    fill: #666;\r\n  }\r\n  &:active svg {\r\n    fill: #333;\r\n  }\r\n`\r\n\r\nexport default IconButton\r\n\r\nexport const CancelButton = styled(IconButton)`\r\n  background-color: red;\r\n  .MuiSvgIcon-root {\r\n    fill: #fff !important;\r\n  }\r\n`\r\n\r\nexport const ConfirmButton = styled(IconButton)`\r\n  background-color:  #00dc00;\r\n  .MuiSvgIcon-root {\r\n    fill: #fff !important;\r\n  }\r\n`","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport PropTypes from 'prop-types'\r\nimport isEqual from 'lodash.isequal'\r\nimport * as d3 from 'd3'\r\n\r\nimport { validateDimensions, validateMeasures } from 'helpers'\r\n\r\nconst xValue = d => d.measures[0].value\r\nconst yValue = d => d.measures[1].value\r\nconst sizeValue = d => d.measures[2] ? d.measures[2].value : 5\r\n\r\nfunction ScatterPlot({ data:newData, width, height, onDimensionClick, selections, title, dotSizeRange, theme, xTickFormat, yTickFormat, xTickCount, yTickCount, TooltipComponent }) {\r\n  const svgContainer = useRef()\r\n  const toolTipRef = useRef()\r\n\r\n  dotSizeRange = dotSizeRange || [4, 8]\r\n\r\n  const [w, setW] = useState(0)\r\n  const [h, setH] = useState(0)\r\n\r\n  const [scales, setScales] = useState({\r\n    x: null,\r\n    y: null\r\n  })\r\n  \r\n  const [data, setData] = useState(null)\r\n\r\n  const xLabel = newData[0].measures[0].label\r\n  const yLabel = newData[0].measures[1].label\r\n\r\n  const margin = { left: yLabel ? 100 : 60, right: 30, top: title ? 50 : 15, bottom: xLabel ? 70 : 35 }\r\n\r\n  useEffect(() => {\r\n    setData(curr => isEqual(curr, newData) ? curr : newData)\r\n  }, [newData])\r\n\r\n  useEffect(() => {\r\n    setW(width - (margin.left + margin.right))\r\n    setH(height - (margin.top + margin.bottom))\r\n  }, [width, height, margin])\r\n\r\n  useEffect(() => {\r\n    setScales({\r\n      x: d3.scaleLinear(),\r\n      y: d3.scaleLinear()\r\n    })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if(data && scales.x) {\r\n      scales.x.domain([0, 1])\r\n      scales.y.domain([0, d3.max(data, d => yValue(d))]).nice()\r\n    }\r\n  }, [data, scales])\r\n\r\n  useEffect(() => {\r\n    if(w && h) {\r\n      scales.x.range([0, w])\r\n      scales.y.range([h, 0])\r\n    }\r\n  }, [scales, w, h])\r\n\r\n  useEffect(() => {\r\n    if(scales.y) {\r\n      const g = d3.select(svgContainer.current).select('.inner-box')\r\n      \r\n      const dotSizeScale = sizeValue(data[0]) ? d3.scaleLinear()\r\n        .domain(d3.extent(data.map(d => sizeValue(d))))\r\n        .range([dotSizeRange[0], dotSizeRange[1]]) : () => (dotSizeRange[0] + dotSizeRange[1]) * 0.4\r\n\r\n      const colorScale = theme.colorScales.sequential(d3.extent(data.map(d => sizeValue(d))))\r\n\r\n      // data points\r\n      const points = g.select('.points').selectAll('circle').data(data)\r\n      points.enter()\r\n        .append('circle')\r\n        .attr('cx', d => scales.x(xValue(d)))\r\n        .attr('cy', h)\r\n        .style('opacity', 0)\r\n        .merge(points)\r\n        .transition()\r\n        .duration(800)\r\n          .attr('class', 'point')\r\n          .attr('cx', d => scales.x(xValue(d)))\r\n          .attr('cy', d => scales.y(yValue(d)))\r\n          .attr('r', d => selections.includes(d.qElemNumber) ? dotSizeScale(sizeValue(d))*1.15 : dotSizeScale(sizeValue(d)))\r\n          .style('fill', d => colorScale(sizeValue(d)))\r\n          .style('opacity', d => selections.includes(d.qElemNumber) ? 1 : 0.75)\r\n          .style('stroke', d => selections.includes(d.qElemNumber) ? theme.selectionHighlight : null)\r\n          .style('stroke-width', dotSizeRange[0] / 4 + 'px')\r\n\r\n      points.exit()\r\n        .transition()\r\n        .duration(600)\r\n        .style('opacity', 0)\r\n        .attr('cy', h)\r\n        .remove()\r\n      \r\n      // tooltips\r\n      var tooltip = d3.select(toolTipRef.current)\r\n\r\n      const circles = g.select('.points').selectAll('circle')\r\n\r\n      // event handlers\r\n      circles.on('mouseover', function(d) {\r\n\r\n        tooltip.select('.title').text(d.dimensions[0].value)\r\n          tooltip.select('.content').text('')\r\n          d.measures.forEach(x => {\r\n            tooltip.select('.content')\r\n              .append('span')\r\n              .attr('class', 'measure')\r\n              .html(`<span>${x.label}</span>&nbsp;&nbsp;&nbsp;<strong>${x.format(x.value)}</strong>`)\r\n          })\r\n        tooltip\r\n          .style(\"opacity\", 1)\r\n\r\n        d3.select(this)\r\n          .attr('r', dotSizeScale(sizeValue(d))*1.15)\r\n          .style('opacity', null)\r\n      })\r\n      circles.on('mousemove', function(d) {\r\n        tooltip\r\n          .style('transform', `translateX(calc(${margin.left + scales.x(xValue(d))}px - 50%)) translateY(calc(${(scales.y(yValue(d)))}px - 110%))`)\r\n      })\r\n      circles.on('mouseout', function(d) {\r\n        tooltip\r\n          .style(\"opacity\", 0)\r\n        d3.select(this)\r\n          .attr('r', selections.includes(d.qElemNumber) ? dotSizeScale(sizeValue(d))*1.15 : dotSizeScale(sizeValue(d)))\r\n          .style('stroke', selections.includes(d.qElemNumber) ? theme.selectionHighlight : null)\r\n          .style('opacity', selections.includes(d.qElemNumber) ? 1 : 0.75)\r\n      })\r\n      circles.on('click', function(d) {\r\n        onDimensionClick(d)\r\n      })\r\n    }\r\n  }, [scales, w, h, data, onDimensionClick, selections, dotSizeRange, theme, margin])\r\n\r\n  useEffect(() => {\r\n    if(scales.y) {\r\n      const g = d3.select(svgContainer.current).select('.inner-box')\r\n      \r\n      const xAxis = d3.axisBottom(scales.x)\r\n        .tickSize(-h)\r\n      xAxis.tickFormat(data[0].measures[0].format)\r\n      if(xTickCount) {\r\n        xAxis.ticks(xTickCount)\r\n      }\r\n\r\n      g.select('.x.axis').call(xAxis)\r\n        .transition()\r\n        .duration(400)\r\n        .attr('transform', `translate(0,${h})`)\r\n        .selectAll('text')\r\n          .attr('transform', 'translate(0, 5)')\r\n\r\n      const yAxis = d3.axisLeft(scales.y)\r\n        .tickSize(-w)\r\n      yAxis.tickFormat(data[0].measures[1].format)\r\n      if(yTickCount) {\r\n        yAxis.ticks(yTickCount)\r\n      }\r\n\r\n      g.select('.y.axis').call(yAxis)\r\n        .style('opacity', 0)\r\n        .transition()\r\n        .duration(400)\r\n        .style('opacity', 1)\r\n        .selectAll('text')\r\n          .attr('transform', 'translate(-5, 0)')\r\n      g.select('.y.axis').enter()\r\n\r\n      g.selectAll('.axis .tick:nth-of-type(1) line').style('stroke', theme.axisLines.stroke)\r\n      g.selectAll('.axis text')\r\n        .style('fill', theme.axisText.color)\r\n      g.selectAll('.axis .domain')\r\n        .style('display', 'none')\r\n      g.selectAll('.axis .tick:not(:nth-of-type(1)) line')\r\n        .attr('stroke', theme.gridLines ? theme.gridLines.stroke : null)\r\n        .attr('stroke-width', theme.gridLines ? theme.gridLines.strokeWidth : null)\r\n        .style('display', theme.gridLines ? 'auto' : 'none')\r\n    }\r\n  }, [data, w, h, scales, theme, xTickCount, xTickFormat, yTickCount, yTickFormat])\r\n\r\n  return (\r\n    <>\r\n      <svg\r\n        ref={svgContainer} \r\n        width={width} \r\n        height={height}\r\n      >\r\n        <g \r\n          className=\"inner-box\" \r\n          pointerEvents=\"all\" \r\n          transform={`translate(${margin.left}, ${margin.top})`}\r\n        >\r\n          <g className=\"x axis\" />\r\n          <g className=\"y axis\" />\r\n          <g className=\"points\"></g>\r\n          <text \r\n            className=\"x-axis-label\"\r\n            transform={`translate(${w/2}, ${h + (margin.bottom / 2) + 10})`}\r\n            textAnchor=\"middle\"\r\n          >\r\n            { xLabel }\r\n          </text>\r\n          <text \r\n            className=\"y-axis-label\" \r\n            transform={`translate(${-60}, ${h/2}) rotate(-90)`}\r\n            textAnchor=\"middle\"\r\n          >\r\n            { yLabel }\r\n          </text>\r\n        </g>\r\n        <text \r\n          className=\"chart-title\"\r\n          fill=\"#000\" \r\n          transform={`translate(${width/2}, ${margin.top/2 + 3})`}\r\n          textAnchor=\"middle\"\r\n        >\r\n          { title }\r\n        </text>\r\n      </svg>\r\n      <TooltipComponent ref={toolTipRef} />\r\n    </>\r\n  )\r\n}\r\n\r\nScatterPlot.propTypes = {\r\n  data: PropTypes.arrayOf(PropTypes.exact({\r\n    dimensions: (props, propName, compName) => validateDimensions(props, propName, compName, 1, 1),\r\n    measures: (props, propName, compName) => validateMeasures(props, propName, compName, 2, 3),\r\n    qElemNumber: PropTypes.number.isRequired,\r\n  })),\r\n  height: PropTypes.number.isRequired,\r\n  width: PropTypes.number.isRequired,\r\n  onDimensionClick: PropTypes.func.isRequired,\r\n  selections: PropTypes.arrayOf(PropTypes.number).isRequired,\r\n  xLabel: PropTypes.string,\r\n  yLabel: PropTypes.string,\r\n  title: PropTypes.string,\r\n  dotSizeRange: PropTypes.array,\r\n  theme: PropTypes.object.isRequired\r\n}\r\n\r\nexport default ScatterPlot","import React, {useState, useEffect, useRef, useCallback} from 'react'\r\nimport * as d3 from 'd3'\r\n\r\nimport PropTypes from 'prop-types'\r\n\r\nimport { validateDimensions, validateMeasures, calculateTextSpace } from 'helpers'\r\n\r\nconst { lasso } = require('d3-lasso')\r\n\r\nconst xValue = d => d.dimensions[0].value\r\nconst yValue = d => d.measures[0].value\r\n\r\nfunction BarChart(props) {\r\n  const { theme, lassoActive:lassoA, hasLasso, data:newData, width, height, selections, onDimensionClick, chartTitle, viewbox, yTickFormat, xTickFormat, xTickCount, yTickCount, TooltipComponent } = props\r\n  const [chartData, setChartData] = useState([]) //setting the initial state\r\n  const svgContainer = useRef()\r\n\r\n  const lassoActive = useRef(lassoA)\r\n  const toolTipRef = useRef()\r\n\r\n  const [h, setH] = useState(0)\r\n  const [h2, setH2] = useState(0)\r\n  const [w, setW] = useState(0)\r\n  const [scales, setScales] = useState({\r\n    x: null,\r\n    y: null,\r\n    boxY: null,\r\n    boxX: null\r\n  })\r\n  const [readyToRender, setReadyToRender] = useState(false)\r\n\r\n  const xLabel = newData[0].dimensions[0].label\r\n  const yLabel = newData[0].measures[0].label\r\n\r\n  const [margin, setMargin] = useState({ \r\n    top: 30, \r\n    right: yLabel ? Math.min(Math.max(width * 0.07, 40), 80) : Math.min(Math.max(width * 0.05, 30), 60), \r\n    middle: 0,\r\n    left: yLabel ? Math.min(Math.max(width * 0.1, 80), 130) : Math.min(Math.max(width * 0.05, 30), 60), \r\n    bottom: 20 \r\n  })\r\n  \r\n  const scaleTo = viewbox === false ? 1 : Math.max(1, 23 / (w / chartData.length))\r\n\r\n  useEffect(() => {\r\n    if(newData.length > 0) {\r\n      setChartData(newData)\r\n    }\r\n  }, [newData])\r\n\r\n  const svg = useCallback(() => d3.select(svgContainer.current), [])\r\n\r\n  useEffect(() => {\r\n    const longestWord = newData.map(xValue).reduce((acc, str) => str.length > acc.length ? str : acc, xValue(newData[0]))\r\n    let s = calculateTextSpace(longestWord, theme.axisText.fontSize, theme.axisText.fontFamily)\r\n    s = Math.sqrt(Math.pow(s, 2) / 2)\r\n\r\n    setMargin(curr => ({...curr, middle: s + (xLabel ? 60 : 20)}))\r\n  }, [width, height, svg, newData, theme, xLabel])\r\n  \r\n  useEffect(() => {\r\n    if(margin.middle) {\r\n      const innerWidth = width - (margin.left + margin.right)\r\n      setW(innerWidth)\r\n      const sumMargin = scaleTo > 1 ? (margin.top + margin.middle + margin.bottom) : (margin.top + margin.middle)\r\n      const innerHeight = height - sumMargin\r\n      const viewboxHeight = scaleTo > 1 ? innerHeight * 0.175 : 0\r\n      setH(innerHeight - viewboxHeight)\r\n      setH2(viewboxHeight)\r\n\r\n      setReadyToRender(true)\r\n    }\r\n  }, [width, height, svg, margin, scaleTo])\r\n\r\n  useEffect(() => {\r\n    const x = d3.scaleBand()\r\n      .range([0, w])\r\n      .padding(0.35)\r\n    \r\n    const boxX = d3.scaleBand()\r\n      .range([0, w])\r\n      .padding(0.35)\r\n      \r\n    const y = d3.scaleLinear()\r\n      .range([h, 0])\r\n\r\n    const boxY = d3.scaleLinear()\r\n      .range([h2, 0])\r\n\r\n    setScales({ x, y, boxY, boxX })\r\n\r\n  }, [w, h, h2])\r\n  \r\n  useEffect(() => {\r\n    if(readyToRender) {\r\n      const g = d3.select(svgContainer.current).select('.inner-box')\r\n\r\n      const data = chartData   \r\n      const xScale = scales.x\r\n      const yScale = scales.y\r\n      const boxYScale = scales.boxY\r\n      const boxXScale = scales.boxX\r\n      \r\n      xScale.domain(data.map(xValue))\r\n      boxXScale.domain(xScale.domain())\r\n\r\n      yScale.domain([0, d3.max(data, d => yValue(d))]).nice()\r\n      boxYScale.domain([0, d3.max(data, d => yValue(d))]).nice()\r\n\r\n      const mainBars = g.select('.bars').selectAll('rect').data(data)\r\n      const viewboxBars = g.select('.viewbox.bars').selectAll('rect').data(data)\r\n      const allBars = g.selectAll('.bars').selectAll('rect').data(data)\r\n\r\n      const percentiles = {\r\n        lower: d3.quantile(data, 0.05, d => yValue(d)),\r\n        upper: d3.quantile(data, 0.9, d => yValue(d))\r\n      }\r\n\r\n      const scaleExtent = [1, 8]\r\n\r\n      // zoom\r\n      const extent = [[0, margin.top], [w, h]]\r\n\r\n      var zoom = d3.zoom()\r\n        .scaleExtent(scaleExtent)\r\n        .translateExtent(extent)\r\n        .extent(extent)\r\n        .filter(() => !d3.event.wheelDelta)\r\n\r\n      const colorScale = theme.colorScales.sequential([percentiles.upper, percentiles.lower])\r\n\r\n      const getOpacity = d => selections.includes(d.qElemNumber) ? 1 : 0.75\r\n      const getStrokeColor = d => selections && selections.includes(d.qElemNumber) ? theme.selectionHighlight : 'none'\r\n\r\n      const isViewbox = elemArray => elemArray[0].parentNode.matches('.viewbox')\r\n\r\n      const getHeight = d => {\r\n        return h - yScale(yValue(d)) > 0 ? h - yScale(yValue(d)) : 0\r\n      }\r\n\r\n      // brush\r\n      const handleBrush = () => {\r\n        if (d3.event.sourceEvent && d3.event.sourceEvent.type === 'zoom') return\r\n        const s = d3.event.selection || boxXScale.range()\r\n\r\n        xScale.range([0,w*scaleTo].map(x => x - s[0]*scaleTo))\r\n\r\n        mainBars\r\n          .attr('width', xScale.bandwidth())\r\n          .attr('height', getHeight)\r\n          .attr('x', d => xScale(xValue(d)))\r\n          .style('opacity', getOpacity)\r\n        viewboxBars\r\n          .attr('opacity', d => boxXScale(xValue(d)) > s[0] && boxXScale(xValue(d)) + boxXScale.bandwidth() < s[1] ? 1 : 0.7)\r\n        g.select('.x.axis')\r\n          .call(d3.axisBottom(xScale))\r\n      }\r\n\r\n      const brush = d3.brushX()\r\n        .extent([[0, h+margin.middle], [w, h+margin.middle+h2]])\r\n        .on('brush end', handleBrush)\r\n      g.select('.brush')\r\n        .call(brush)\r\n        .call(brush.move, boxXScale.range())\r\n        .selectAll('.handle, .overlay')\r\n          .attr('pointer-events', 'none')\r\n      \r\n      // zoom\r\n      const handleZoom = () => {\r\n        if (d3.event.sourceEvent && d3.event.sourceEvent.type === 'brush') return\r\n        d3.event.transform.k = scaleTo\r\n        xScale.range([0, w].map(d => d3.event.transform.applyX(d)))\r\n        \r\n        mainBars\r\n          .attr('width', xScale.bandwidth())\r\n          .attr('height', getHeight)\r\n          .attr('x', d => xScale(xValue(d)))\r\n          .style('opacity', getOpacity)\r\n        g.select('.x.axis')\r\n          .call(d3.axisBottom(xScale))\r\n          .selectAll('text')\r\n            .attr('transform', `rotate(-45) translate(-10, -6)`)\r\n        const t = d3.event.transform\r\n        g.select('.brush')\r\n          .call(brush.move, boxXScale.range().map(t.invertX, t))\r\n      }\r\n\r\n      if(lassoActive.current) {\r\n        zoom.on('zoom', null)\r\n      } else {\r\n        zoom.on('zoom', handleZoom)\r\n      }\r\n\r\n      g.call(zoom)\r\n      \r\n      if(d3.zoomTransform(g).k !== scaleTo) {\r\n        zoom.scaleTo(g, scaleTo, [0, 0])\r\n      }\r\n\r\n      const getViewboxHeight = d => (h2 - boxYScale(yValue(d)))> 0 ? (h2 - boxYScale(yValue(d))) : 0\r\n\r\n      // Bars - ENTER\r\n      allBars.enter()\r\n        .append('rect')\r\n        .merge(allBars)\r\n        .transition()\r\n        .duration(250)\r\n        .attr('class', 'bar')\r\n        .attr('width', (d, i, e) => isViewbox(e) ? boxXScale.bandwidth() : xScale.bandwidth())\r\n        .attr('height', (d, i, e) => isViewbox(e) ? getViewboxHeight(d) : getHeight(d))\r\n        .attr('x', (d, i, e) => isViewbox(e) ? boxXScale(xValue(d)) : xScale(xValue(d)))\r\n        .attr('y', (d, i, e) => isViewbox(e) ? boxYScale(yValue(d)) : yScale(yValue(d)))\r\n        .attr('fill', d => colorScale(yValue(d)))\r\n        .attr('stroke', getStrokeColor)\r\n        .attr('stroke-width', 1)\r\n        .attr('clip-path', 'url(#inner-clip)')\r\n\r\n      // Bars - EXIT\r\n      allBars.exit()\r\n        .transition()\r\n        .duration(250)\r\n        .attr('x', -xScale.bandwidth() - 10)\r\n        .style('opacity', 0)\r\n        .remove()\r\n        \r\n      const onLassoStart = () => {\r\n        if(!lassoActive.current) return\r\n        las.items()\r\n        .attr('r', 3.5)\r\n        .classed('not_possible', true)\r\n          .classed('selected', false)\r\n      }\r\n\r\n      const onLassoDraw = () => {\r\n        if(!lassoActive.current) return\r\n        // Style the possible dots\r\n        las.possibleItems()\r\n          .classed('not_possible',false)\r\n          .classed('possible',true)\r\n\r\n        // Style the not possible dot\r\n        las.notPossibleItems()\r\n          .classed('not_possible',true)\r\n          .classed('possible',false)\r\n      }\r\n\r\n      const onLassoEnd = () => {\r\n        if(!lassoActive.current) return\r\n        // Reset the color of all dots\r\n        las.items()\r\n          .classed('not_possible',false)\r\n          .classed('possible',false)\r\n\r\n        let selected = []\r\n\r\n        // Style the selected dots\r\n        las.selectedItems()\r\n          .each(d => selected.push(d.qElemNumber))\r\n        \r\n        onLassoEnd(selected)\r\n\r\n        // Reset the style of the not selected dots\r\n        las.notSelectedItems()\r\n      }\r\n\r\n      if(g.select('.lasso').nodes().length === 0 && hasLasso) {\r\n        var las = lasso(d3)\r\n          .closePathSelect(true)\r\n          .closePathDistance(100)\r\n          .items(mainBars.data(data))\r\n          .targetArea(g)\r\n\r\n        las.on('start', onLassoStart)\r\n        las.on('draw', onLassoDraw)\r\n        las.on('end', onLassoEnd)\r\n        \r\n        g.call(las)\r\n      }\r\n\r\n      var tooltip = d3.select(toolTipRef.current)\r\n\r\n      // Bars - Mouseover\r\n      mainBars\r\n        .on('mouseover', function(d) {\r\n          d3.select(this)\r\n            .style('opacity', 1)\r\n\r\n          tooltip.select('.title').text(d.dimensions[0].value)\r\n          tooltip.select('.content').text('')\r\n          d.measures.forEach(x => {\r\n            tooltip.select('.content')\r\n              .append('span')\r\n              .attr('class', 'measure')\r\n              .html(`<span>${x.label}</span>&nbsp;&nbsp;&nbsp;<strong>${x.format(x.value)}</strong>`)\r\n          })\r\n          \r\n          tooltip.style('opacity', 1)\r\n        })\r\n        .on('mousemove', function(d) {\r\n          tooltip\r\n            .style('transform', `translateX(calc(${margin.left + xScale(xValue(d)) + xScale.bandwidth()/2}px - 50%)) translateY(${yScale(yValue(d)) - 30}px)`)\r\n        })\r\n        .on('mouseout', function(d) {\r\n          tooltip\r\n            .style(\"opacity\", 0)\r\n          d3.select(this)\r\n            .transition('restoreBarColor')\r\n            .duration(150)\r\n            .style('opacity', getOpacity)\r\n        })\r\n        .on('click', function(d) {\r\n          onDimensionClick(d)\r\n        })\r\n    }\r\n\r\n  }, [chartData, scales, w, h, h2, onDimensionClick, lassoActive, selections, theme, svg, hasLasso, margin, readyToRender, scaleTo])\r\n\r\n  useEffect(() => {\r\n    if(scales.y) {\r\n      const g = d3.select(svgContainer.current)\r\n\r\n      // y axis\r\n      const yAxis = d3.axisLeft(scales.y)\r\n      yAxis.tickFormat(chartData[0].measures[0].format)\r\n      if(yTickCount) {\r\n        yAxis.ticks(yTickCount)\r\n      }\r\n      g.select('.y.axis').call(yAxis)\r\n        .transition()\r\n        .duration(300)\r\n\r\n      // x axis\r\n      const xAxis = d3.axisBottom(scales.x)\r\n      if(xTickFormat) {\r\n        xAxis.tickFormat(xTickFormat)\r\n      }\r\n      if(xTickCount) {\r\n        xAxis.ticks(xTickCount)\r\n      }\r\n      g.select('.x.axis')\r\n      .call(xAxis)\r\n        .transition()\r\n        .duration(300)\r\n        .attr('transform', `translate(0,${h})`)\r\n\r\n        .attr('clip-path', 'url(#outer-clip)')\r\n        .selectAll('text')\r\n          .attr('transform', 'rotate(-45) translate(-10, -6)')\r\n          .style('text-anchor', 'end')\r\n          .attr('dx', '6')\r\n          .attr('dy', '4')\r\n\r\n      g.select('.x.axis').selectAll('.domain, .tick line')\r\n        .attr('clip-path', 'url(#inner-clip)')\r\n\r\n      // title\r\n      g.select('.chart-title')\r\n        .attr('transform', `translate(${w/2}, -35)`) \r\n        .style('text-anchor', 'middle')\r\n        .style('font-size', '25px')\r\n        .style('font-weight', 'bold')\r\n    }\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <svg \r\n        ref={svgContainer}\r\n        width={width} \r\n        height={height}\r\n      >\r\n        <text \r\n          className='chart-title' \r\n          fill='#fff'\r\n        >\r\n          { chartTitle }\r\n        </text>\r\n        <text \r\n          transform={`translate(${w/2 + margin.left}, ${h + margin.middle})`}\r\n          className=\"x-axis-label\"\r\n          textAnchor=\"middle\"\r\n        >\r\n          { xLabel }\r\n        </text>\r\n        <text \r\n          className='y-axis-label' \r\n          transform={`translate(${margin.left*0.5 - (theme.labels.xAxis.fontSize || theme.labels.fontSize).replace(/\\D/g,'')}, ${h/2 + margin.top}) rotate(-90)`}\r\n          textAnchor=\"middle\"\r\n        >\r\n          { yLabel }\r\n        </text>\r\n        <g \r\n          className='inner-box' \r\n          pointerEvents='all' \r\n          transform={`translate(${margin.left}, ${margin.top})`}\r\n        >\r\n          <rect \r\n            className='zoom-sensor' \r\n            transform={`translate(0, -${margin.top})`} \r\n            width={w} \r\n            height={height} \r\n            style={{fill: 'none'}} \r\n            pointerEvents='all'\r\n          />\r\n\r\n          <g className='bars' />\r\n          <g className='x axis' />\r\n          <g className='y axis' />\r\n          { scaleTo !== 1 ? <>\r\n            <g \r\n              className='viewbox' \r\n              transform={`translate(0, ${h + margin.middle})`}\r\n              pointerEvents='none'\r\n            >\r\n              <rect \r\n                fill={theme.viewbox.backgroundFill}\r\n                width={w}\r\n                height={h2}\r\n              />\r\n              <g className='viewbox bars' />\r\n            </g>\r\n            <g className='brush' /> \r\n          </> : <></> }\r\n          \r\n          <clipPath id='inner-clip'>\r\n            <rect \r\n              transform={`translate(0, -${margin.top})`} \r\n              width={w} \r\n              height={height}\r\n            />\r\n          </clipPath>\r\n          <clipPath id='outer-clip'>\r\n            <rect \r\n              transform={`translate(-8, -${margin.top})`} \r\n              width={w+8} \r\n              height={height}\r\n            />\r\n          </clipPath>\r\n        </g>\r\n      </svg>\r\n      <TooltipComponent ref={toolTipRef} />\r\n    </>\r\n  )\r\n}\r\n\r\nBarChart.propTypes = {\r\n  data: PropTypes.arrayOf(PropTypes.exact({\r\n    dimensions: (props, propName, compName) => validateDimensions(props, propName, compName, 1, 1),\r\n    measures: (props, propName, compName) => validateMeasures(props, propName, compName, 1, 1),\r\n    qElemNumber: PropTypes.number.isRequired,\r\n  })),\r\n  height: PropTypes.number.isRequired,\r\n  width: PropTypes.number.isRequired,\r\n  onDimensionClick: PropTypes.func.isRequired,\r\n  selections: PropTypes.arrayOf(PropTypes.number).isRequired,\r\n  xLabel: PropTypes.string,\r\n  yLabel: PropTypes.string,\r\n  title: PropTypes.string,\r\n  dotColor: PropTypes.string,\r\n  dotSizeRange: PropTypes.array,\r\n  theme: PropTypes.object.isRequired\r\n}\r\n\r\nexport default BarChart\r\n","import React, {useState, useEffect, useRef, useCallback} from 'react'\r\nimport * as d3 from 'd3'\r\n\r\nimport PropTypes from 'prop-types'\r\n\r\nimport { validateDimensions, validateMeasures, calculateTextSpace } from 'helpers'\r\n\r\nconst { lasso } = require('d3-lasso')\r\n\r\nconst xValue = d => d.dimensions[0].value\r\nconst yValue = d => d.measures[0].value\r\n\r\nfunction LineChart(props) {\r\n  const { theme, lassoActive:lassoA, hasLasso, data:newData, width, height, selections, onDimensionClick, chartTitle, viewbox, yTickFormat, xTickFormat, xTickCount, yTickCount, TooltipComponent } = props\r\n  const [chartData, setChartData] = useState([]) //setting the initial state\r\n  const svgContainer = useRef()\r\n\r\n  const lassoActive = useRef(lassoA)\r\n  const toolTipRef = useRef()\r\n\r\n  const [h, setH] = useState(0)\r\n  const [h2, setH2] = useState(0)\r\n  const [w, setW] = useState(0)\r\n  const [scales, setScales] = useState({\r\n    x: null,\r\n    y: null,\r\n    boxY: null,\r\n    boxX: null\r\n  })\r\n  const [readyToRender, setReadyToRender] = useState(false)\r\n\r\n  const xLabel = newData[0].dimensions[0].label\r\n  const yLabel = newData[0].measures[0].label\r\n\r\n  const [margin, setMargin] = useState({ \r\n    top: 30, \r\n    right: yLabel ? Math.min(Math.max(width * 0.07, 40), 80) : Math.min(Math.max(width * 0.05, 30), 60), \r\n    middle: 0,\r\n    left: yLabel ? Math.min(Math.max(width * 0.1, 80), 130) : Math.min(Math.max(width * 0.05, 30), 60), \r\n    bottom: 20 \r\n  })\r\n  \r\n  const scaleTo = viewbox === false ? 1 : Math.max(1, 23 / (w / chartData.length))\r\n\r\n  useEffect(() => {\r\n    if(newData.length > 0) {\r\n      setChartData(newData.sort((a, b) => a.dimensions[0].value - b.dimensions[0].value))\r\n    }\r\n  }, [newData])\r\n\r\n  const svg = useCallback(() => d3.select(svgContainer.current), [])\r\n\r\n  useEffect(() => {\r\n    const longestWord = newData.map(xValue).reduce((acc, str) => str.length > acc.length ? str : acc, xValue(newData[0]))\r\n    let s = calculateTextSpace(longestWord, theme.axisText.fontSize, theme.axisText.fontFamily)\r\n    s = Math.sqrt(Math.pow(s, 2) / 2)\r\n\r\n    setMargin(curr => ({...curr, middle: s + (xLabel ? 60 : 20)}))\r\n  }, [width, height, svg, newData, theme, xLabel])\r\n  \r\n  useEffect(() => {\r\n    if(margin.middle) {\r\n      const innerWidth = width - (margin.left + margin.right)\r\n      setW(innerWidth)\r\n      const sumMargin = scaleTo > 1 ? (margin.top + margin.middle + margin.bottom) : (margin.top + margin.middle)\r\n      const innerHeight = height - sumMargin\r\n      const viewboxHeight = scaleTo > 1 ? innerHeight * 0.175 : 0\r\n      setH(innerHeight - viewboxHeight)\r\n      setH2(viewboxHeight)\r\n\r\n      setReadyToRender(true)\r\n    }\r\n  }, [width, height, svg, margin, scaleTo])\r\n\r\n  useEffect(() => {\r\n    const x = d3.scaleLinear()\r\n      .range([0, w])\r\n    \r\n    const boxX = d3.scaleBand()\r\n      .range([0, w])\r\n      .padding(0.35)\r\n      \r\n    const y = d3.scaleLinear()\r\n      .range([h, 0])\r\n\r\n    const boxY = d3.scaleLinear()\r\n      .range([h2, 0])\r\n\r\n    setScales({ x, y, boxY, boxX })\r\n\r\n  }, [w, h, h2])\r\n  \r\n  useEffect(() => {\r\n    if(readyToRender) {\r\n      const g = d3.select(svgContainer.current).select('.inner-box')\r\n\r\n      const data = chartData   \r\n      const xScale = scales.x\r\n      const yScale = scales.y\r\n      const boxYScale = scales.boxY\r\n      const boxXScale = scales.boxX\r\n      \r\n      xScale.domain(d3.extent(data, d => xValue(d))).nice()\r\n      boxXScale.domain(xScale.domain())\r\n\r\n      const padLinear = ([x0, x1], k) => {\r\n        const dx = (x1 - x0) * k / 2\r\n        return [x0 - dx, x1 + dx]\r\n      }\r\n\r\n      yScale.domain(padLinear(d3.extent(data, d => yValue(d)), 0.7)).nice()\r\n      boxYScale.domain(yScale.domain())\r\n\r\n      const mainBars = g.select('.bars').selectAll('circle').data(data)\r\n      const viewboxBars = g.select('.viewbox.bars').selectAll('circle').data(data)\r\n      const allBars = g.selectAll('.bars').selectAll('circle').data(data)\r\n\r\n      const percentiles = {\r\n        lower: d3.quantile(data, 0.05, d => yValue(d)),\r\n        upper: d3.quantile(data, 0.9, d => yValue(d))\r\n      }\r\n\r\n      const scaleExtent = [1, 8]\r\n\r\n      // zoom\r\n      const extent = [[0, margin.top], [w, h]]\r\n\r\n      var zoom = d3.zoom()\r\n        .scaleExtent(scaleExtent)\r\n        .translateExtent(extent)\r\n        .extent(extent)\r\n        .filter(() => !d3.event.wheelDelta)\r\n\r\n      const colorScale = theme.colorScales.sequential([percentiles.lower, percentiles.upper])\r\n\r\n      const getOpacity = d => selections.includes(d.qElemNumber) ? 1 : 0.75\r\n      const getStrokeColor = d => selections && selections.includes(d.qElemNumber) ? theme.selectionHighlight : 'none'\r\n\r\n      const isViewbox = elemArray => elemArray[0].parentNode.matches('.viewbox')\r\n\r\n      const getHeight = d => {\r\n        return h - yScale(yValue(d)) > 0 ? h - yScale(yValue(d)) : 0\r\n      }\r\n\r\n      // brush\r\n      const handleBrush = () => {\r\n        if (d3.event.sourceEvent && d3.event.sourceEvent.type === 'zoom') return\r\n        const s = d3.event.selection || boxXScale.range()\r\n\r\n        xScale.range([0,w*scaleTo].map(x => x - s[0]*scaleTo))\r\n\r\n        mainBars\r\n          .attr('cx', (d, i, e) => isViewbox(e) ? boxXScale(xValue(d)) : xScale(xValue(d)))\r\n          .style('opacity', getOpacity)\r\n        viewboxBars\r\n          .attr('opacity', d => boxXScale(xValue(d)) > s[0] && boxXScale(xValue(d)) < s[1] ? 1 : 0.7)\r\n        g.select('.x.axis')\r\n          .call(d3.axisBottom(xScale))\r\n\r\n        g.select('.line')\r\n          .transition()\r\n          .duration(500)\r\n          .attr('d', d3.line()\r\n            .x(d => xScale(xValue(d)))\r\n            .y(d => yScale(yValue(d)))\r\n          )\r\n      }\r\n\r\n      const brush = d3.brushX()\r\n        .extent([[0, h+margin.middle], [w, h+margin.middle+h2]])\r\n        .on('brush end', handleBrush)\r\n      g.select('.brush')\r\n        .call(brush)\r\n        .call(brush.move, boxXScale.range())\r\n        .selectAll('.handle, .overlay')\r\n          .attr('pointer-events', 'none')\r\n      \r\n      // zoom\r\n      const handleZoom = () => {\r\n        if (d3.event.sourceEvent && d3.event.sourceEvent.type === 'brush') return\r\n        d3.event.transform.k = scaleTo\r\n        xScale.range([0, w].map(d => d3.event.transform.applyX(d)))\r\n        \r\n        mainBars\r\n          .attr('cx', (d, i, e) => isViewbox(e) ? boxXScale(xValue(d)) : xScale(xValue(d)))\r\n          .style('opacity', getOpacity)\r\n        g.select('.x.axis')\r\n          .call(d3.axisBottom(xScale))\r\n          .selectAll('text')\r\n            .attr('transform', `rotate(-45) translate(-10, -6)`)\r\n        const t = d3.event.transform\r\n        g.select('.brush')\r\n          .call(brush.move, boxXScale.range().map(t.invertX, t))\r\n\r\n        g.select('.line')\r\n          .transition()\r\n          .duration(500)\r\n          .attr('d', d3.line()\r\n            .x(d => xScale(xValue(d)))\r\n            .y(d => yScale(yValue(d)))\r\n          )\r\n      }\r\n\r\n      if(lassoActive.current) {\r\n        zoom.on('zoom', null)\r\n      } else {\r\n        zoom.on('zoom', handleZoom)\r\n      }\r\n\r\n      g.call(zoom)\r\n      \r\n      if(d3.zoomTransform(g).k !== scaleTo) {\r\n        zoom.scaleTo(g, scaleTo, [0, 0])\r\n      }\r\n\r\n      const getViewboxHeight = d => (h2 - boxYScale(yValue(d)))> 0 ? (h2 - boxYScale(yValue(d))) : 0\r\n\r\n      // Bars - ENTER\r\n      allBars.enter()\r\n        .append('circle')\r\n        .merge(allBars)\r\n        .transition()\r\n        .duration(250)\r\n        .attr('class', 'bar')\r\n        .attr('r', (d, i, e) => isViewbox(e) ? 1 : 3)\r\n        .attr('cx', (d, i, e) => isViewbox(e) ? boxXScale(xValue(d)) : xScale(xValue(d)))\r\n        .attr('cy', (d, i, e) => isViewbox(e) ? boxYScale(yValue(d)) : yScale(yValue(d)))\r\n        .attr('fill', d => colorScale(d3.max(data, yValue)))\r\n        .attr('stroke', getStrokeColor)\r\n        .attr('stroke-width', 1)\r\n        .attr('clip-path', 'url(#inner-clip)')\r\n\r\n      // Bars - EXIT\r\n      allBars.exit()\r\n        .transition()\r\n        .duration(250)\r\n        .attr('x', -13)\r\n        .style('opacity', 0)\r\n        .remove()\r\n\r\n      g.select('.line')\r\n        .datum(data)\r\n        .transition()\r\n        .duration(500)\r\n        .attr('d', d3.line()\r\n          .x(d => xScale(xValue(d)))\r\n          .y(d => yScale(yValue(d)))\r\n        )\r\n        .attr('fill', 'none')\r\n        .attr('stroke', colorScale(d3.median(data, yValue)))\r\n        .attr('stroke-width', 1.3)\r\n        \r\n      const onLassoStart = () => {\r\n        if(!lassoActive.current) return\r\n        las.items()\r\n        .attr('r', 3.5)\r\n        .classed('not_possible', true)\r\n          .classed('selected', false)\r\n      }\r\n\r\n      const onLassoDraw = () => {\r\n        if(!lassoActive.current) return\r\n        // Style the possible dots\r\n        las.possibleItems()\r\n          .classed('not_possible',false)\r\n          .classed('possible',true)\r\n\r\n        // Style the not possible dot\r\n        las.notPossibleItems()\r\n          .classed('not_possible',true)\r\n          .classed('possible',false)\r\n      }\r\n\r\n      const onLassoEnd = () => {\r\n        if(!lassoActive.current) return\r\n        // Reset the color of all dots\r\n        las.items()\r\n          .classed('not_possible',false)\r\n          .classed('possible',false)\r\n\r\n        let selected = []\r\n\r\n        // Style the selected dots\r\n        las.selectedItems()\r\n          .each(d => selected.push(d.qElemNumber))\r\n        \r\n        onLassoEnd(selected)\r\n\r\n        // Reset the style of the not selected dots\r\n        las.notSelectedItems()\r\n      }\r\n\r\n      if(g.select('.lasso').nodes().length === 0 && hasLasso) {\r\n        var las = lasso(d3)\r\n          .closePathSelect(true)\r\n          .closePathDistance(100)\r\n          .items(mainBars.data(data))\r\n          .targetArea(g)\r\n\r\n        las.on('start', onLassoStart)\r\n        las.on('draw', onLassoDraw)\r\n        las.on('end', onLassoEnd)\r\n        \r\n        g.call(las)\r\n      }\r\n\r\n      var tooltip = d3.select(toolTipRef.current)\r\n\r\n      // Bars - Mouseover\r\n      mainBars\r\n        .on('mouseover', function(d) {\r\n          d3.select(this)\r\n            .style('opacity', 1)\r\n\r\n          tooltip.select('.title').text(d.dimensions[0].value)\r\n          tooltip.select('.content').text('')\r\n          d.measures.forEach(x => {\r\n            tooltip.select('.content')\r\n              .append('span')\r\n              .attr('class', 'measure')\r\n              .html(`<span>${x.label}</span>&nbsp;&nbsp;&nbsp;<strong>${x.format(x.value)}</strong>`)\r\n          })\r\n          \r\n          tooltip.style('opacity', 1)\r\n        })\r\n        .on('mousemove', function(d) {\r\n          tooltip\r\n            .style('transform', `translateX(calc(${margin.left + xScale(xValue(d))}px - 50%)) translateY(${yScale(yValue(d)) - 30}px)`)\r\n        })\r\n        .on('mouseout', function(d) {\r\n          tooltip\r\n            .style(\"opacity\", 0)\r\n          d3.select(this)\r\n            .transition('restoreBarColor')\r\n            .duration(150)\r\n            .style('opacity', getOpacity)\r\n        })\r\n        .on('click', function(d) {\r\n          onDimensionClick(d)\r\n        })\r\n    }\r\n\r\n  }, [chartData, scales, w, h, h2, onDimensionClick, lassoActive, selections, theme, svg, hasLasso, margin, readyToRender, scaleTo])\r\n\r\n  useEffect(() => {\r\n    if(scales.y) {\r\n      const g = d3.select(svgContainer.current)\r\n\r\n      // y axis\r\n      const yAxis = d3.axisLeft(scales.y)\r\n      yAxis.tickFormat(chartData[0].measures[0].format)\r\n      if(yTickCount) {\r\n        yAxis.ticks(yTickCount)\r\n      }\r\n      g.select('.y.axis').call(yAxis)\r\n        .transition()\r\n        .duration(300)\r\n\r\n      // x axis\r\n      const xAxis = d3.axisBottom(scales.x)\r\n      if(xTickFormat) {\r\n        xAxis.tickFormat(xTickFormat)\r\n      }\r\n      if(xTickCount) {\r\n        xAxis.ticks(xTickCount)\r\n      }\r\n      g.select('.x.axis')\r\n      .call(xAxis)\r\n        .transition()\r\n        .duration(300)\r\n        .attr('transform', `translate(0,${h})`)\r\n\r\n        .attr('clip-path', 'url(#outer-clip)')\r\n        .selectAll('text')\r\n          .attr('transform', 'rotate(-45) translate(-10, -6)')\r\n          .style('text-anchor', 'end')\r\n          .attr('dx', '6')\r\n          .attr('dy', '4')\r\n\r\n      g.select('.x.axis').selectAll('.domain, .tick line')\r\n        .attr('clip-path', 'url(#inner-clip)')\r\n\r\n      // title\r\n      g.select('.chart-title')\r\n        .attr('transform', `translate(${w/2}, -35)`) \r\n        .style('text-anchor', 'middle')\r\n        .style('font-size', '25px')\r\n        .style('font-weight', 'bold')\r\n    }\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <svg \r\n        ref={svgContainer}\r\n        width={width} \r\n        height={height}\r\n      >\r\n        <text \r\n          className='chart-title' \r\n          fill='#fff'\r\n        >\r\n          { chartTitle }\r\n        </text>\r\n        <text \r\n          transform={`translate(${w/2 + margin.left}, ${h + margin.middle})`}\r\n          className=\"x-axis-label\"\r\n          textAnchor=\"middle\"\r\n        >\r\n          { xLabel }\r\n        </text>\r\n        <text \r\n          className='y-axis-label' \r\n          transform={`translate(${margin.left*0.5 - (theme.labels.xAxis.fontSize || theme.labels.fontSize).replace(/\\D/g,'')}, ${h/2 + margin.top}) rotate(-90)`}\r\n          textAnchor=\"middle\"\r\n        >\r\n          { yLabel }\r\n        </text>\r\n        <g \r\n          className='inner-box' \r\n          pointerEvents='all' \r\n          transform={`translate(${margin.left}, ${margin.top})`}\r\n        >\r\n          <rect \r\n            className='zoom-sensor' \r\n            transform={`translate(0, -${margin.top})`} \r\n            width={w} \r\n            height={height} \r\n            style={{fill: 'none'}} \r\n            pointerEvents='all'\r\n          />\r\n\r\n          <path className='line' clipPath='url(#inner-clip)'></path>\r\n          <g className='bars' />\r\n          <g className='x axis' />\r\n          <g className='y axis' />\r\n          { scaleTo !== 1 ? <>\r\n            <g \r\n              className='viewbox' \r\n              transform={`translate(0, ${h + margin.middle})`}\r\n              pointerEvents='none'\r\n            >\r\n              <rect \r\n                fill={theme.viewbox.backgroundFill}\r\n                width={w}\r\n                height={h2}\r\n              />\r\n              <g className='viewbox bars' />\r\n            </g>\r\n            <g className='brush' /> \r\n          </> : <></> }\r\n          \r\n          <clipPath id='inner-clip'>\r\n            <rect \r\n              transform={`translate(0, -${margin.top})`} \r\n              width={w} \r\n              height={height}\r\n            />\r\n          </clipPath>\r\n          <clipPath id='outer-clip'>\r\n            <rect \r\n              transform={`translate(-8, -${margin.top})`} \r\n              width={w+8} \r\n              height={height}\r\n            />\r\n          </clipPath>\r\n        </g>\r\n      </svg>\r\n      <TooltipComponent ref={toolTipRef} />\r\n    </>\r\n  )\r\n}\r\n\r\nLineChart.propTypes = {\r\n  data: PropTypes.arrayOf(PropTypes.exact({\r\n    dimensions: (props, propName, compName) => validateDimensions(props, propName, compName, 1, 1),\r\n    measures: (props, propName, compName) => validateMeasures(props, propName, compName, 1, 1),\r\n    qElemNumber: PropTypes.number.isRequired,\r\n  })),\r\n  height: PropTypes.number.isRequired,\r\n  width: PropTypes.number.isRequired,\r\n  onDimensionClick: PropTypes.func.isRequired,\r\n  selections: PropTypes.arrayOf(PropTypes.number).isRequired,\r\n  xLabel: PropTypes.string,\r\n  yLabel: PropTypes.string,\r\n  title: PropTypes.string,\r\n  dotColor: PropTypes.string,\r\n  dotSizeRange: PropTypes.array,\r\n  theme: PropTypes.object.isRequired\r\n}\r\n\r\nexport default LineChart\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport * as d3 from 'd3'\r\n\r\nconst margin = { left: 0, top: 0, right: 0, bottom: 0 }\r\n\r\nconst getField = d => d.dimensions[0].value\r\nconst getValue = d => d.measures[0].value\r\n\r\nexport default function PieChart({ width, height, data, theme, TooltipComponent, onDimensionClick, selections }) {\r\n\r\n  const svgContainer = useRef()\r\n  const toolTipRef = useRef()\r\n\r\n  const [offsetAngle, setOffsetAngle] = useState(0)\r\n  \r\n  useEffect(() => {\r\n    if(data && data.length > 0) {\r\n\r\n      const percentiles = {\r\n        lower: d3.quantile(data, 0.05, d => getValue(d)),\r\n        upper: d3.quantile(data, 0.9, d => getValue(d))\r\n      }\r\n\r\n      const colorScale = theme.colorScales.sequential([percentiles.upper, percentiles.lower])\r\n\r\n      const g = d3.select(svgContainer.current).select('g')\r\n\r\n      let arcData = d3.pie().padAngle(0.01).value(d => getValue(d))(data)\r\n\r\n      arcData = arcData.map(d => ({\r\n        ...d,\r\n        startAngle: d.startAngle + offsetAngle,\r\n        endAngle: d.endAngle + offsetAngle\r\n      }))\r\n\r\n      const paths = g.select('.paths').selectAll('path').data(arcData)\r\n      \r\n      const holeScale = 0.7\r\n      const radius = Math.min(width, height) / 2\r\n    \r\n      const getArc = radius => d3.arc().innerRadius(radius * holeScale).outerRadius(radius - 1)\r\n\r\n      const largeArc = getArc(radius)\r\n      const smallArc = getArc(radius * 0.68)\r\n\r\n      paths\r\n        .attr('d', d => smallArc(d))\r\n        .attr('stroke', d => selections.includes(d.data.qElemNumber) ? theme.selectionHighlight : 'transparent')\r\n\r\n      const getPathOpacity = d => selections.includes(d.data.qElemNumber) ? 1 : 0.8\r\n\r\n      paths.enter()\r\n        .append('path')\r\n        .attr('d', d => smallArc(d))\r\n        .attr('fill', d => colorScale(d.value))\r\n        .attr('stroke', d => selections.includes(d.data.qElemNumber) ? '#fff' : 'transparent')\r\n        .attr('opacity', getPathOpacity)\r\n        .append('text')\r\n        .text(d => d.value)\r\n        .attr(\"transform\", d => `translate(${smallArc.centroid(d)})`)\r\n\r\n      paths.exit()\r\n        .remove()\r\n\r\n      g.selectAll('.labels g').remove()\r\n      \r\n      const labels = g.select('.labels').selectAll('g').data(arcData)\r\n\r\n      const getOpacity = d => Math.abs(largeArc.centroid(d)[1]) < radius*0.70 ? 1 : 0\r\n\r\n      labels.enter()\r\n        // .filter(d => Math.abs(largeArc.centroid(d)[1]) < radius*0.75)\r\n        .append('g')\r\n        .call(g => g.append('text')\r\n          .text(d => getField(d.data))\r\n          .attr('font-size', 8)\r\n          .attr('fill', theme.axisText.color)\r\n          .attr('opacity', getOpacity)\r\n          .attr('transform', d => `translate(${largeArc.centroid(d)})`)\r\n          .attr('text-anchor', d => largeArc.centroid(d)[0] > 0 ? 'start' : 'end')\r\n        )\r\n        .call(g => g.append('line')\r\n          .attr('x1', d => getArc(radius*0.83).centroid(d)[0])\r\n          .attr('y1', d => getArc(radius*0.83).centroid(d)[1])\r\n          .attr('x2', d => getArc(radius*0.95).centroid(d)[0])\r\n          .attr('y2', d => getArc(radius*0.95).centroid(d)[1])\r\n          .attr('opacity', getOpacity)\r\n          .attr('stroke', theme.axisText.color)\r\n          .attr('stroke-width', 0.8)\r\n        )\r\n\r\n      var tooltip = d3.select(toolTipRef.current)\r\n      \r\n      paths\r\n        .on('mouseover', function(d) {\r\n          d3.select(this)\r\n            .style('opacity', 1)\r\n\r\n          tooltip.select('.title').text(getField(d.data))\r\n          tooltip.select('.content').text('')\r\n          tooltip.select('.content')\r\n            .append('span')\r\n            .attr('class', 'measure')\r\n            .html(`<span>${getField(d.data)}</span>&nbsp;&nbsp;&nbsp;<strong>${Math.round(d.value)}</strong>`)\r\n          \r\n          tooltip.style('opacity', 1)\r\n        })\r\n        .on('mousemove', function(d) {\r\n          const coords = smallArc.centroid(d)\r\n          tooltip\r\n            .style('transform', `translateX(calc(${coords[0] + width/2}px - 50%)) translateY(calc(${coords[1] + height/2 - 30}px - 50%))`)\r\n        })\r\n        .on('mouseout', function(d) {\r\n          tooltip\r\n            .style(\"opacity\", 0)\r\n          d3.select(this)\r\n            .transition('restoreBarColor')\r\n            .duration(150)\r\n            .style('opacity', getPathOpacity)\r\n        })\r\n        .on('click', (d) => {\r\n          onDimensionClick(d.data)\r\n        })\r\n    }\r\n  }, [data, offsetAngle, selections, height, theme, onDimensionClick, width])\r\n\r\n  const handleWheel = e => {\r\n    const delt = e.deltaY\r\n    setOffsetAngle(curr => curr + 0.1 * Math.sign(delt))\r\n    d3.select(toolTipRef.current).style('opacity', 0)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <svg \r\n        ref={svgContainer}\r\n        width={width} \r\n        height={height}\r\n        onWheel={handleWheel}\r\n      >\r\n        <g\r\n          transform={`translate(${margin.left + width/2}, ${margin.top + height/2})`}\r\n        >\r\n          <g className=\"paths\"></g>\r\n          <g className=\"labels\"></g>\r\n        </g>\r\n      </svg>\r\n      <TooltipComponent ref={toolTipRef} />\r\n    </>\r\n  )\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst StyledTooltip = styled.div`\r\n  position: absolute;\r\n  pointer-events: none;\r\n  top: 0;\r\n  left: 0;\r\n  opacity: ${props => props.show ? 1 : 0};\r\n  padding: 6px 16px 7px 16px;\r\n  font-size: 0.8em;\r\n  background-color: rgba(30,30,30,0.65);\r\n  color: #fff;\r\n  border-radius: 3px;\r\n  &::after {\r\n    content: \"\";\r\n    position: absolute;\r\n    top: 100%;\r\n    opacity: 1;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    border-width: 9px;\r\n    border-color: rgba(30,30,30,0.85) transparent transparent transparent;\r\n    border-style: solid;\r\n  }\r\n  .title {\r\n    font-size: 0.8em;\r\n    font-weight: 600;\r\n    display: block;\r\n    margin-bottom: 5px;\r\n  }\r\n  .subtitle {\r\n    font-size: 0.8em;\r\n    color: #777;\r\n  }\r\n  .content {\r\n    font-size: 0.7em;\r\n    line-height: 1.4;\r\n    .measure {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      strong {\r\n        font-weight: 500;\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nconst ChartTooltip = React.forwardRef((props, ref) => (\r\n  <StyledTooltip\r\n    className=\"tooltip\"\r\n    ref={ref}\r\n  >\r\n    <span className=\"title\">\r\n      <span className=\"subtitle\"></span>\r\n    </span>\r\n    <div className=\"content\"></div>\r\n  </StyledTooltip>\r\n))\r\n\r\nexport default ChartTooltip","import React, { useEffect, useState, useCallback, useRef, useContext } from 'react'\r\n\r\nimport PropTypes from 'prop-types'\r\nimport styled from 'styled-components'\r\nimport { ThemeProvider } from 'styled-components'\r\n\r\nimport loadTheme from 'themes/loadTheme'\r\nimport StyledGenericChart from 'themes/StyledGenericChart'\r\n\r\nimport WinContext from 'context/win'\r\nimport ThemeContext from 'context/theme'\r\nimport ObjectsContext from 'context/objects'\r\nimport SelectionsContext from 'context/selections'\r\nimport useChecks from 'hooks/useChecks'\r\n\r\nimport { ReactComponent as CloseIcon } from 'assets/icons/close.svg'\r\nimport { ReactComponent as DoneIcon } from 'assets/icons/done.svg'\r\n\r\nimport { CancelButton, ConfirmButton } from 'components/atoms/IconButton'\r\n\r\nimport ScatterPlot from 'components/molecules/ScatterPlot'\r\nimport BarChart from 'components/molecules/BarChart'\r\nimport LineChart from 'components/molecules/LineChart'\r\nimport PieChart from 'components/molecules/PieChart'\r\nimport ChartTooltip from 'components/molecules/ChartTooltip'\r\n\r\nimport { ordinalize } from 'helpers'\r\n\r\nconst charts = {\r\n  'barchart': BarChart,\r\n  'scatterplot': ScatterPlot,\r\n  'linechart': LineChart,\r\n  'piechart': PieChart\r\n}\r\n\r\nconst ChartContainer = styled.div`\r\n  margin-bottom: 30px;\r\n  border: 1px solid transparent;\r\n  border-radius: 5px;\r\n  position: relative;\r\n`\r\n\r\nconst ChartControls = styled.div`\r\n  padding: 4px 8px;\r\n  border-radius: 5px;\r\n  z-index: 3;\r\n  position: absolute;\r\n  right: 0;\r\n  top: 6px;\r\n  display: flex;\r\n  background-color: ${({ theme }) => theme.backgroundColor};\r\n  svg {\r\n    fill: #fff !important;\r\n  }\r\n`\r\n\r\nfunction Chart({ documentTitle ,objectId, dimensions, measures, title, xLabel, yLabel, theme: propTheme, viewbox, type: propChartType, xTickFormat, yTickFormat, xTickCount, yTickCount, height: propHeight }) {\r\n  const { dimMeasureCheck } = useChecks()\r\n\r\n  const { createObject, getObject, getObjectLayout } = useContext(ObjectsContext)\r\n  const { selections, selectValues, endSelections } = useContext(SelectionsContext)\r\n  const { theme: contextTheme } = useContext(ThemeContext)\r\n  const win = useContext(WinContext)\r\n\r\n  const containerRef = useRef()\r\n  const chartType = useRef()\r\n\r\n  const [theme, setTheme] = useState(null)\r\n  const [showChart, setShowChart] = useState(false)\r\n  const [model, setModel] = useState(null)\r\n  const [data, setData] = useState(null)\r\n  const [width, setWidth] = useState(0)\r\n  const [height, setHeight] = useState(0)\r\n\r\n  useEffect(() => {\r\n    let toSet\r\n    if (propTheme) {\r\n      if (typeof propTheme === 'string') {\r\n        toSet = loadTheme(propTheme)\r\n      } else {\r\n        toSet = propTheme\r\n      }\r\n    } else {\r\n      toSet = contextTheme\r\n    }\r\n    setTheme(toSet)\r\n  }, [propTheme, contextTheme])\r\n\r\n  useEffect(() => {\r\n    if(propChartType) {\r\n      chartType.current = propChartType\r\n      if(!charts[chartType.current]) {\r\n        throw new Error(`Unrecognized chart type, \"${chartType.current}\" provided to Chart component. \r\n        Currently supported chart types are: ${Object.keys(charts).join(', ')}`)\r\n      }\r\n      setShowChart(true)\r\n    }\r\n  }, [propChartType])\r\n\r\n  const updateLayout = useCallback(model => {\r\n    return getObjectLayout(model).then(layout => {\r\n      const {qDimensionInfo:dimInfo, qMeasureInfo:mesInfo} = layout.qHyperCube\r\n      const newData = layout.qHyperCube.qDataPages[0].qMatrix.map(x => ({\r\n        qElemNumber: x[0].qElemNumber,\r\n        dimensions: x.slice(0, dimInfo.length).map((d, i) => ({\r\n          label: dimensions && dimensions[i] && measures[i].label ? dimensions[i].label : dimInfo[i].qFallbackTitle,\r\n          value: d.qNum === 'NaN' ? d.qText : d.qNum\r\n        })),\r\n        measures: x.slice(dimInfo.length).map((d, i) => ({\r\n          label: measures && measures[i] && measures[i].label ? measures[i].label : mesInfo[i].qFallbackTitle,\r\n          format: measures ? (measures[i].format || (d => d)) : (d => d),\r\n          value: d.qNum\r\n        }))\r\n      }))\r\n      setData(newData)\r\n      return layout\r\n    })\r\n  }, [dimensions, getObjectLayout, measures])\r\n\r\n  useEffect(() => {\r\n    setWidth(containerRef.current.getBoundingClientRect().width)\r\n    setHeight(propHeight || containerRef.current.getBoundingClientRect().height)\r\n  }, [win.width, propHeight])\r\n\r\n  useEffect(() => {\r\n    document.title = documentTitle\r\n    if (!model) {\r\n      if(objectId) {\r\n        getObject(objectId).then(m => {\r\n          setModel(m)\r\n          updateLayout(m).then(layout => {\r\n            if(!propChartType) {\r\n              chartType.current = layout.qInfo.qType\r\n              if(!charts[chartType.current]) {\r\n                throw new Error(`Unrecognized chart type, \"${chartType.current}\" provided to Chart component. \r\n                Currently supported chart types are: ${Object.keys(charts).join(', ')}`)\r\n              }\r\n              setShowChart(true)\r\n            }\r\n          })\r\n          m.on('changed', () => {\r\n            updateLayout(m)\r\n          })\r\n        })\r\n      } else {\r\n        dimMeasureCheck(dimensions, measures, propChartType)\r\n        const def = {\r\n          qDimensions: dimensions.map(x => {\r\n            x = typeof x === 'string' ? { field: x } : x\r\n            return {\r\n              qDef: { qFieldDefs: [x.field] },\r\n              qNullSuppression: x.excludeNull ? true : false,\r\n            }\r\n          }),\r\n          qMeasures: measures.map(x => {\r\n            x = typeof x === 'string' ? { formula: x } : x\r\n            const e = { qDef: { qDef: x.formula } }\r\n            return x.sorting ? { ...e, qSortBy: x.sorting } : e\r\n          }),\r\n          qInitialDataFetch: [{ qTop: 0, qLeft: 0, qWidth: dimensions.length + measures.length, qHeight: 100 }]\r\n        }\r\n        createObject('cube', def).then(m => {\r\n          setModel(m)\r\n          updateLayout(m)\r\n          m.on('changed', () => {\r\n            updateLayout(m)\r\n          })\r\n        })\r\n      }\r\n    }\r\n  }, [documentTitle, model, dimensions, measures, updateLayout, chartType, dimMeasureCheck, createObject, objectId, getObject, propChartType])\r\n\r\n  const handleDimensionClick = d => {\r\n    selectValues(model.id, [d.qElemNumber]).then(() => {\r\n      updateLayout(model)\r\n    })\r\n  }\r\n\r\n  const handleEndSelect = i => {\r\n    endSelections(true).then(() => {\r\n      updateLayout(model)\r\n    })\r\n  }\r\n\r\n  const handleClearSelect = i => {\r\n    endSelections(false).then(() => {\r\n      updateLayout(model)\r\n    })\r\n  }\r\n\r\n  const RequestedChart = charts[chartType.current]\r\n\r\n  return (\r\n    <ChartContainer\r\n      ref={containerRef}\r\n      className={`${chartType}-feature`}\r\n      style={{ borderColor: selections.values.length > 0 && selections.selectedModelId === model.id ? '#bbb' : 'transparent' }}\r\n    >\r\n      {data && theme && data.length > 0 ?\r\n        <ThemeProvider theme={theme}>\r\n          <ChartControls\r\n            className=\"controls\"\r\n            style={{\r\n              display: selections.values.length > 0 && selections.selectedModelId === model.id ? 'flex' : 'none'\r\n            }}\r\n          >\r\n            <CancelButton onClick={handleClearSelect}>\r\n              <CloseIcon />\r\n            </CancelButton>\r\n            <ConfirmButton onClick={handleEndSelect}>\r\n              <DoneIcon />\r\n            </ConfirmButton>\r\n          </ChartControls>\r\n          <StyledGenericChart className=\"chart\">\r\n            { showChart && <RequestedChart\r\n              data={data}\r\n              selections={selections.selectedModelId === model.id ? selections.values : []}\r\n              onDimensionClick={handleDimensionClick}\r\n              width={width}\r\n              height={height}\r\n              xLabel={xLabel}\r\n              yLabel={yLabel}\r\n              title={title}\r\n              theme={theme}\r\n              dotSizeRange={[4, 9]}\r\n              viewbox={viewbox}\r\n              xTickFormat={xTickFormat}\r\n              yTickFormat={yTickFormat}\r\n              xTickCount={xTickCount}\r\n              yTickCount={yTickCount}\r\n              TooltipComponent={ChartTooltip}\r\n/> }\r\n          </StyledGenericChart>\r\n        </ThemeProvider>\r\n        : <p>No data</p>}\r\n    </ChartContainer>\r\n  )\r\n}\r\n\r\nfunction toType(obj) {\r\n  return ({}).toString.call(obj).match(/\\s([a-zA-Z]+)/)[1].toLowerCase()\r\n}\r\n\r\nChart.propTypes = {\r\n  dimensions: (props, propName, compName) => {\r\n    const dims = props[propName]\r\n    if(!dims) {\r\n      return props.objectId ? null : new Error(`Unless providing an 'objectId' prop to fetch an existing visualization from the connected app, the 'dimensions' prop must be passed to ${compName}. Please provide this prop or provide an 'objectId' prop.`)\r\n    }\r\n    if (!Array.isArray(dims)) { return new Error(`Dimensions passed to ${compName} must be an array. Please check the props passed.`) }\r\n    for (const [i, dim] of dims.entries()) {\r\n      const type = toType(dim)\r\n      if (!['string', 'object'].includes(type)) {\r\n        return new Error(`The ${ordinalize(i + 1)} dimension passed to ${compName} is a ${type}. Dimensions passed must be an object (containing a field property, plus any other config), or a string representing the field name`)\r\n      }\r\n      if (type === 'object') {\r\n        if (!dim.field && !props.objectId) {\r\n          return new Error(`The ${ordinalize(i + 1)} dimension passed to ${compName} does not include a 'field' property. Dimensions must include a 'field' property at minimum, or be passed as a string representing the field name.`)\r\n        }\r\n      }\r\n    }\r\n  },\r\n  measures: (props, propName, compName) => {\r\n    const measures = props[propName]\r\n    if(!measures) {\r\n      return props.objectId ? null : new Error(`Unless providing an 'objectId' prop to fetch an existing visualization from the connected app, the 'measures' prop must be passed to ${compName}. Please provide this prop or provide an 'objectId' prop.`)\r\n    }\r\n    if (!Array.isArray(measures)) { return new Error(`Measures passed to ${compName} must be an array. Please check the props passed.`) }\r\n    for (const [i, measure] of measures.entries()) {\r\n      const type = toType(measure)\r\n      if (!['string', 'object'].includes(type)) {\r\n        return new Error(`The ${ordinalize(i + 1)} measure passed to ${compName} is a ${type}. Measures passed must be an object (containing 'formula' and 'label'', plus any other config), or a string representing the formula`)\r\n      }\r\n      if (type === 'object') {\r\n        if (!measure.formula && !props.objectId) {\r\n          return new Error(`The ${ordinalize(i + 1)} measure passed to ${compName} does not include a 'formula' property. Measures must include 'formula' and 'label' properties at minimum.`)\r\n        }\r\n        if(!measure.label) {\r\n          return new Error(`The ${ordinalize(i + 1)} measure passed to ${compName} does not include a 'label' property. Measures must include a 'label' property to correctly display tooltips and chart labels. This applies even if the chart uses a getObject, as tooltips will not have info on measure names.`)\r\n        }\r\n      }\r\n    }\r\n  },\r\n  type: PropTypes.oneOf(Object.keys(charts))\r\n}\r\n\r\nexport default Chart","import { useContext, useCallback } from 'react'\r\nimport QlikContext from 'context/qlik'\r\nimport {ordinalize} from 'helpers'\r\n\r\nexport default function useChecks(value) {\r\n  const {app} = useContext(QlikContext)\r\n  \r\n  const dimMeasureCheck = useCallback(async (dims, measures, compName) => {\r\n    for(const [i, dim] of dims.entries()) {\r\n      const field = dim.field || dim\r\n      try {\r\n        await app.getField(field)\r\n      }\r\n      catch(err) {\r\n        throw new Error(`The field '${field}', passed as the ${ordinalize(i+1)} dimension to a ${compName} component was not found in the connected Qlik app. Please check that the value has been passed correctly, and that it is a field not a master dimension.`)\r\n      }\r\n    }\r\n    for(const [i, measure] of measures.entries()) {\r\n      const formula = measure.formula || measure\r\n      const isValid = await app.checkExpression(formula)\r\n      if(isValid.qErrorMsg) {\r\n        throw new Error(`The measure '${formula}', passed as the ${ordinalize(i+1)} measure to a ${compName} component was flagged as having invalid syntax by the connected Qlik app.\r\n  Please check your expression syntax and ensure there are no typos`)\r\n      }\r\n      if(isValid.qBadFieldNames.length > 0) {\r\n        throw new Error(`The measure '${formula}', passed as the ${ordinalize(i+1)} measure to a ${compName} component was flagged by the connected Qlik app as containing an invalid field. \r\n  Please check that the value has been passed correctly, and is a valid Qlik sense expression containing fields which exist in the connected app.`)\r\n      }\r\n      if(isValid.qDangerousFieldNames.length > 0) {\r\n        console.warn(`The measure '${formula}', passed as the ${ordinalize(i+1)} measure to a ${compName} component was flagged by the connected Qlik app as containing a dangerous field.`)\r\n      }\r\n    }\r\n  }, [app])\r\n\r\n  return {dimMeasureCheck}\r\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z\"\n});\n\nvar SvgStepBack = function SvgStepBack(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgStepBack, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/step_back.64de3847.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"path\", {\n  id: \"a\",\n  d: \"M0 0h24v24H0V0z\"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"clipPath\", {\n  id: \"b\"\n}, /*#__PURE__*/React.createElement(\"use\", {\n  xlinkHref: \"#a\",\n  overflow: \"visible\"\n}));\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"path\", {\n  clipPath: \"url(#b)\",\n  d: \"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79 2.73 2.71 7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58 3.51-3.47 9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z\"\n});\n\nvar SvgStepNext = function SvgStepNext(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgStepNext, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/step_next.ebcf00f4.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar SvgCancel = function SvgCancel(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgCancel, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/cancel.b6512207.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect, useState, useRef, useContext } from 'react'\r\n\r\nimport usePrevious from 'hooks/usePrevious'\r\n\r\nimport ObjectsContext from 'context/objects'\r\nimport SelectionsContext from 'context/selections'\r\n\r\nimport IconButton, { CancelButton, ConfirmButton } from 'components/atoms/IconButton'\r\n\r\nimport { ReactComponent as CloseIcon } from 'assets/icons/close.svg'\r\nimport { ReactComponent as DoneIcon } from 'assets/icons/done.svg'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst FieldListContainer = styled.div`\r\n  position: absolute;\r\n  top: 100%;\r\n  width: 200px;\r\n  z-index: 10;\r\n  svg {\r\n    fill: #fff !important;\r\n  }\r\n`\r\n\r\nconst ValuesList = styled.div`\r\n  color: #333; \r\n  background-color: #fff; \r\n  max-height: 300px; \r\n  overflow-y: auto; \r\n  font-size: 0.6em; \r\n  z-index: 2;\r\n`\r\n\r\nconst ValueButtons = styled.div`\r\n  margin: 7px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  div {\r\n    display: flex;\r\n  }\r\n`\r\n\r\nconst ValueItem = styled.div`\r\n  margin: 1px 0;\r\n  padding: 8px 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n  cursor: default;\r\n  position: relative;\r\n  &.S { background-color: #69ff69 } /* selected */\r\n  &.A { background-color: #ddd } /* selected */\r\n  &.X { background-color: #a9a9a9 } /* excluded */\r\n  &.XS { \r\n    /* selected excluded */\r\n    background-color: #a9a9a9;\r\n    &::after {\r\n      content: '✔';\r\n      position: absolute;\r\n      right: 10px;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n      color: #fff;\r\n      font-size: 14px;\r\n    }\r\n  }\r\n  &:hover {\r\n    &::before {\r\n      position: absolute;\r\n      content: \"\";\r\n      top: 0;\r\n      left: 0;\r\n      bottom: 0;\r\n      right: 0;\r\n      background-color: rgba(0,0,0,0.1);\r\n    }\r\n  }\r\n`\r\n\r\nfunction SelectionsFieldList({ onRequestClose, onClickAway, fieldInfo, fieldIndex, isExpanded, onExpand, onClose, indexOfEl }) {\r\n\r\n  const { createObject, getObjectLayout } = useContext(ObjectsContext)\r\n  const { selections, beginSelections, selectValues, endSelections } = useContext(SelectionsContext)\r\n\r\n  const [model, setModel] = useState(null)\r\n\r\n  const [values, setValues] = useState([])\r\n\r\n  const oldModelId = usePrevious(selections.selectedModelId) \r\n\r\n  const containerRef = useRef()\r\n\r\n  useEffect(() => {\r\n    if(model && oldModelId === model.id && selections.selectedModelId !== model.id) {\r\n      onRequestClose()\r\n    }\r\n  }, [selections.selectedModelId, model, oldModelId, onRequestClose])\r\n\r\n  const handleClick = qElemNumber => {\r\n    selectValues(model.id, [qElemNumber], true)\r\n  }\r\n  \r\n  const discardSelections = () => {\r\n    endSelections(false).then(() => {\r\n      onRequestClose()\r\n    })\r\n  }\r\n\r\n  const confirmSelections = () => {\r\n    endSelections(true).then(() => {\r\n      onRequestClose()\r\n    })\r\n  }\r\n\r\n  const selectAllValues = () => {\r\n    const elems = values.map(x => x.qElemNumber)\r\n    selectValues(model.id, elems, false)\r\n  }\r\n\r\n  const isSubscribed = useRef(false)\r\n\r\n  useEffect(() => {\r\n    const handleClick = e => {\r\n      let isOutside = true\r\n      let elem = e.target\r\n      while(elem.parentNode) {\r\n        if(elem === containerRef.current) {\r\n          isOutside = false\r\n          break;\r\n        }\r\n        elem = elem.parentNode\r\n      }\r\n      if(isOutside) {\r\n        onClickAway()\r\n      }\r\n    }\r\n    document.addEventListener('click', handleClick)\r\n    return () => {\r\n      document.removeEventListener('click', handleClick)\r\n    }\r\n  }, [onClickAway])\r\n\r\n  useEffect(() => {\r\n    isSubscribed.current = true\r\n    const setLayout = m => {\r\n      getObjectLayout(m).then(layout => {\r\n        if(isSubscribed.current) {\r\n          setValues(layout.qListObject.qDataPages[0].qMatrix.flat(1))\r\n        }\r\n        return layout\r\n      })\r\n    }\r\n    if(model) {\r\n      if(isExpanded) {\r\n        beginSelections(model.id)\r\n      }\r\n    } else {\r\n      createObject('list', {\r\n        qDef: {\r\n          qFieldDefs: [fieldInfo.qField],\r\n          qSortCriterias: [\r\n            { qSortByState: 1 } \r\n          ]\r\n        },\r\n        qShowAlternatives: true,\r\n        qInitialDataFetch: [{\r\n          qTop: 0,\r\n          qLeft: 0,\r\n          qWidth: 1,\r\n          qHeight: 100\r\n        }]\r\n      }, `${fieldInfo.qField}_Selections`).then(m => {\r\n        setModel(m)\r\n        if(isExpanded) {\r\n          beginSelections(m.id)\r\n        }\r\n        setLayout(m)\r\n        m.on('changed', () => {\r\n          setLayout(m)\r\n        })\r\n      })\r\n    }\r\n    return () => {\r\n      isSubscribed.current = false\r\n      // if(model) {\r\n      //   setModel(null)\r\n      //   destroyObject(model.id))\r\n      // }\r\n    }\r\n  }, [isExpanded, fieldInfo.qField, model, getObjectLayout, beginSelections, createObject])\r\n\r\n  return (\r\n    <FieldListContainer style={{left: `${fieldIndex * 200}px`}} ref={containerRef}>\r\n      <ValuesList>\r\n        <ValueButtons>\r\n          <IconButton onClick={selectAllValues}>\r\n            Select all\r\n          </IconButton>\r\n          <div>\r\n            <CancelButton onClick={discardSelections}>\r\n              <CloseIcon />\r\n            </CancelButton>\r\n            <ConfirmButton onClick={confirmSelections}>\r\n              <DoneIcon />\r\n            </ConfirmButton>\r\n          </div>\r\n        </ValueButtons>\r\n        { values.map(x => (\r\n          <ValueItem\r\n            key={x.qElemNumber}\r\n            onClick={() => handleClick(x.qElemNumber)}\r\n            className={x.qState}\r\n          >\r\n            {x.qText}\r\n          </ValueItem>\r\n        )) }\r\n      </ValuesList>\r\n    </FieldListContainer>\r\n  )\r\n}\r\n\r\nexport default SelectionsFieldList","import { useRef, useEffect } from 'react'\r\n\r\nexport default function usePrevious(value) {\r\n  const ref = useRef()\r\n  useEffect(() => {\r\n    ref.current = value\r\n  })\r\n  return ref.current\r\n}","import React, { useState, useEffect, useRef, useCallback, useContext } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport IconButton from 'components/atoms/IconButton'\r\n\r\nimport { ReactComponent as StepBackIcon } from 'assets/icons/step_back.svg'\r\nimport { ReactComponent as StepForwardIcon } from 'assets/icons/step_next.svg'\r\nimport { ReactComponent as CancelIcon } from 'assets/icons/cancel.svg'\r\n\r\nimport ObjectsContext from 'context/objects'\r\nimport SelectionsContext from 'context/selections'\r\nimport QlikContext from 'context/qlik'\r\n\r\nimport SelectionsFieldList from 'components/molecules/SelectionsFieldList'\r\n\r\nconst selectionBarHeight = '46px'\r\n\r\nconst SelectionBarContainer = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 100px 1fr;\r\n  height: ${selectionBarHeight};\r\n  background-color: #f2f2f2;\r\n  border: 1px solid #d9d9d9;\r\n  & > div {\r\n    box-sizing: border-box;\r\n    &:nth-of-type(1) {\r\n      border-right: 1px solid #d9d9d9;\r\n    }\r\n    &:nth-of-type(2) {\r\n      background-color: #e6e6e6;\r\n      > div {\r\n        border-right: 1px solid #d9d9d9;\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nconst OptionsContainer = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 0 6px;\r\n`\r\n\r\nconst FieldsContainer = styled.div`\r\n  display: flex;\r\n  height: ${selectionBarHeight};\r\n  border-bottom: 1px solid #d9d9d9;\r\n  position: relative;\r\n`\r\n\r\nconst FieldSummary = styled.div`\r\n  width: 200px;\r\n  padding: 0 10px;\r\n  box-sizing: border-box;\r\n  display: grid;\r\n  grid-template-columns: 150px 22px;\r\n  column-gap: 8px;\r\n  align-content: center;\r\n  font-size: 0.8em;\r\n  overflow: hidden;\r\n  background-color: #fff;\r\n  cursor: pointer;\r\n  .title {\r\n    font-weight: 600;\r\n  }\r\n  .info > span {\r\n    display: block;\r\n    white-space: nowrap;\r\n    font-weight: 400;\r\n    color: #8c8c8c;\r\n  }\r\n  .icon {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    svg {\r\n      fill: #8c8c8c;\r\n    }\r\n    &:hover svg {\r\n      fill: #404040;\r\n    }\r\n  }\r\n  &:hover {\r\n    background-color: #f6f6f6\r\n  }\r\n`\r\n\r\nexport default function SelectionsBar() {\r\n  const { app } = useContext(QlikContext)\r\n  const { objects, createObject, getObjectLayout } = useContext(ObjectsContext)\r\n  const { endSelections, clearFieldSelections } = useContext(SelectionsContext)\r\n  \r\n  const [fields, setFields] = useState([])\r\n\r\n  const [model, setModel] = useState(null)\r\n\r\n  const [selectedField, setSelectedField] = useState(null)\r\n\r\n  const selectionBarRef = useRef()\r\n\r\n  let isSubscribed = useRef(false)\r\n\r\n  useEffect(() => {\r\n    isSubscribed.current = true\r\n    if(!model) {\r\n      const { id } = objects.find(x => x.type === 'selections')\r\n      app.getObject(id).then(model => {\r\n        setModel(model)\r\n        getObjectLayout(model).then(({qSelectionObject:e}) => {\r\n          setFields(e.qSelections)\r\n        })\r\n        model.on('changed', () => {\r\n          getObjectLayout(model).then(({qSelectionObject:e}) => {\r\n            if(isSubscribed.current) {\r\n              setFields(e.qSelections)\r\n            }\r\n          })\r\n        })\r\n      })\r\n    }\r\n    return () => {\r\n      isSubscribed.current = false\r\n      // if(model) {\r\n      //   destroyObject(model.id))\r\n      // }\r\n    }\r\n  }, [model, objects, createObject, getObjectLayout, app])\r\n\r\n  useEffect(() => {\r\n    setSelectedField(null)\r\n  }, [fields.length])\r\n\r\n  const stepBack = () => {\r\n    endSelections(true).then(() => {\r\n      app.back()\r\n    })\r\n  }\r\n\r\n  const stepForward = () => {\r\n    endSelections(true).then(() => {\r\n      app.forward()\r\n    })\r\n  }\r\n\r\n  const handleRequestClose = useCallback(() => setSelectedField(null), [])\r\n\r\n  const handleClearFieldSelections = fieldName => {\r\n    endSelections(true).then(() => {\r\n      clearFieldSelections(fieldName)\r\n      setSelectedField(null)\r\n    })\r\n  }\r\n\r\n  const handleFieldClick = (x, i) => {\r\n    setSelectedField(curr => curr && curr.info.qField === x.qField ? null : { info: x, index: i })\r\n  }\r\n\r\n  const handleClickAway = useCallback(() => {\r\n    endSelections(true).then(() => {\r\n      setSelectedField(null)\r\n    })\r\n  }, [endSelections])\r\n\r\n  const getTitleString = str => str.length > 17 ? str.substr(0, 17) + '...' : str\r\n  \r\n  const getSelectedString = x => x.qSelectedCount > 1 && x.qSelectedCount < 7 ? `${x.qSelectedCount} of ${x.qTotal}` : x.qSelected\r\n\r\n  return (\r\n    <SelectionBarContainer>\r\n      <OptionsContainer>\r\n        <IconButton onClick={stepBack}>\r\n          <StepBackIcon />\r\n        </IconButton>\r\n        <IconButton onClick={stepForward}>\r\n          <StepForwardIcon />\r\n        </IconButton>\r\n      </OptionsContainer>\r\n      <FieldsContainer ref={selectionBarRef}>\r\n        { fields.map((x, i) => (\r\n          <FieldSummary \r\n            key={i}\r\n            onClick={() => handleFieldClick(x, i)}\r\n          >\r\n            <div className=\"text\">\r\n              <span className=\"title\">{getTitleString(x.qField)}</span>\r\n              <span className=\"info\">\r\n                <span>{getSelectedString(x)}</span>\r\n              </span>\r\n            </div>\r\n            <div \r\n              className=\"icon\" \r\n              onClick={e => { e.stopPropagation(); handleClearFieldSelections(x.qField) }}\r\n            >\r\n              <CancelIcon />\r\n            </div>\r\n          </FieldSummary>\r\n        )) }\r\n        { selectedField && \r\n          <SelectionsFieldList\r\n            key={selectedField.info.qField}\r\n            fieldInfo={selectedField.info}\r\n            fieldIndex={selectedField.index}\r\n            onRequestClose={handleRequestClose}\r\n            onClickAway={handleClickAway}\r\n          /> }\r\n      </FieldsContainer>\r\n    </SelectionBarContainer>\r\n  )\r\n}","import React from 'react'\r\n\r\nimport './App.css'\r\n\r\nimport Chart from 'components/organisms/Chart'\r\nimport { HashRouter as Router, Switch, Route } from 'react-router-dom'\r\n\r\nimport SelectionsBar from 'components/organisms/SelectionsBar'\r\n// import * as d3 from 'd3'\r\n\r\nexport default function App() {\r\n  return (\r\n    <Router>\r\n      <div className=\"App\">\r\n        {/* import selections bar if needed. Styling can be fully customised. */}\r\n\r\n        {/* <div className=\"ChartGrid\"> */}\r\n        <Switch>\r\n          <Route path=\"/app0\" component={() => <SelectionsBar />} />\r\n          {/* <Route\r\n            path=\"/app1\"\r\n            component={() => (\r\n              <Chart\r\n                documentTitle=\"Line Chart\"\r\n                type=\"linechart\"\r\n                dimensions={[\r\n                  // add chart dimensions here\r\n                  {\r\n                    field: 'Month', // field name in qlik app (must not be a master item)\r\n                    excludeNull: true, // enables qNullSuppression in the created hypercube\r\n                  },\r\n                ]}\r\n                measures={[\r\n                  // add chart measures here\r\n                  {\r\n                    formula: 'Sum([Sales Margin Amount])', // valid qlik formula from connected app\r\n\r\n                    // set a qlik sorting method, and ascending/descending delta value - see https://bit.ly/2ZUqnvY for available sort criteria. Or remove the property for no sorting.\r\n                    sorting: { qSortByNumberic: -1 },\r\n                    // add a format to apply to each data point\r\n                    format: (v) => d3.format('.2s')(v),\r\n                    // Add label for measure to show beside chart if applicable\r\n                    label: 'Sales margin in Central US',\r\n                  },\r\n                ]}\r\n                // select chart theme - add new themes by creating a json file in themes/charts\r\n                theme=\"sunsetblue\"\r\n                // chart must either have a height specified here, or be in a container with a specified height\r\n                height={300}\r\n              />\r\n            )}\r\n          /> */}\r\n          <Route path=\"/app2\" component={() => <Chart documentTitle=\"Bar Chart\" objectId=\"MRmuW\" height={300} />} />\r\n          {/* <Route path=\"/app3\" component={() => <Chart documentTitle=\"Pie Chart\" objectId=\"MEAjCJ\" height={300} />} /> */}\r\n          <Route path=\"/app4\" component={() => <Chart documentTitle=\"Scatter Plot\" objectId=\"bsxkrg\" height={300} />} />\r\n        </Switch>\r\n      </div>\r\n      {/* </div> */}\r\n    </Router>\r\n  )\r\n}\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nimport { WinProvider } from './win'\r\nimport { ThemeProvider } from './theme'\r\nimport { QlikProvider } from './qlik'\r\nimport { SelectionsProvider } from './selections'\r\nimport { ObjectsProvider } from './objects'\r\n\r\nexport default function GlobalProvider({ children }) {\r\n  return (\r\n    // Any of the below contexts containing functionality not needed can simply be removed from the provider tree here.\r\n    // Note that selections requires the objects provider to work correctly, but the object state management can be kept without selections.\r\n    // Do not remove QlikProvider - this provides global access to the Enigma.js library\r\n    <QlikProvider>\r\n      <WinProvider>\r\n        <ThemeProvider>\r\n          <ObjectsProvider>\r\n            <SelectionsProvider>\r\n              {children}\r\n            </SelectionsProvider>\r\n          </ObjectsProvider>\r\n        </ThemeProvider>\r\n      </WinProvider>\r\n    </QlikProvider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport './index.css'\r\nimport App from './App'\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nimport GlobalProvider from './context/GlobalProvider'\r\n\r\nReactDOM.render(\r\n  // this global provider combines contexts for the qlik api, object state, selection state, theming and viewport size tracking\r\n  <GlobalProvider>\r\n    <App />\r\n  </GlobalProvider>\r\n  , document.getElementById('root')\r\n)\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister()\r\n"],"sourceRoot":""}